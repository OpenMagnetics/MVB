{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"OpenMagnetics Virtual Builder","text":"<ul> <li> <p>Generate 3D Models</p> <p>Create parametric STEP, STL, and OBJ files for 21 magnetic core shape families from MAS schema data.</p> </li> <li> <p>Technical Drawings</p> <p>Produce annotated SVG, DXF, and FreeCAD macro 2D drawings with dimension lines and gapping details.</p> </li> <li> <p>Dual CAD Engines</p> <p>Choose between CadQuery (pure Python, no system dependencies) and FreeCAD (full CAD functionality).</p> </li> <li> <p>Complete Assemblies</p> <p>Build full magnetic components including cores, bobbins, coils, and windings.</p> </li> </ul> <p> </p>"},{"location":"#what-is-mvb","title":"What is MVB?","text":"<p>Magnetics Virtual Builder (MVB) generates FreeCAD and CadQuery based files from any magnetic component defined following the MAS (Magnetic Assembly Schema) standard. Output includes:</p> <ul> <li>3D models: <code>.step</code>, <code>.stl</code>, <code>.obj</code> files</li> <li>2D technical drawings: <code>.svg</code>, <code>.dxf</code>, <code>.FCMacro</code> files</li> <li>Meshes for simulation</li> </ul>"},{"location":"#quick-example","title":"Quick Example","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\n\n# Create a builder with the CadQuery engine (default)\nbuilder = Builder(\"CadQuery\")\n\n# List all available core shape families\nfamilies = builder.get_families()\nprint(list(families.keys()))\n# ['etd', 'er', 'ep', 'epx', 'pq', 'e', 'pm', 'p', 'rm', ...]\n</code></pre>"},{"location":"#supported-shape-families","title":"Supported Shape Families","text":"Family Shapes Description E Family E, ETD, ER, EFD, EC, EQ, EP, EPX E-shaped cores and variants P Family P, PQ, PM, RM Pot cores and variants Planar PLANAR_E, PLANAR_ER, PLANAR_EL, LP Low-profile planar cores U Family U, UR, UT U-shaped cores Toroidal T Ring / toroidal cores C Cores C C-shaped cut cores"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li>Installation - Get up and running</li> <li>Quick Start - Generate your first core in 5 minutes</li> <li>Architecture - Understand how MVB works</li> <li>API Reference - Full API documentation</li> <li>Shape Catalog - Browse all supported shapes</li> </ul>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#2026","title":"2026","text":""},{"location":"changelog/#february-2026","title":"February 2026","text":"<p>Added</p> <ul> <li>Add MkDocs Material documentation site with API reference, tutorials, and shape catalog (<code>b7129b4</code>)</li> <li>Add image to README for project visualization (<code>93f18b7</code>)</li> <li>Address Copilot review: narrow exceptions, consolidate imports, tighten SVG assertions (<code>5c9e4f5</code>)</li> <li>Add toroidal and C-core full pipeline tests, fix SVG cross-section crash (<code>8700fc6</code>)</li> <li>Address Copilot review: edge filter, import placement, DXF test (<code>8002868</code>)</li> <li>Add 2D drawing engine with HLR projection for SVG/DXF/FCMacro export (<code>f4555d1</code>)</li> <li>Add pre-commit hooks (ruff + vulture) and fix all lint issues (<code>fe8ded1</code>)</li> <li>Add MAS-based winding support with turnsDescription coordinates (<code>bf4c095</code>)</li> </ul> <p>Changed</p> <ul> <li>Update Usage section with accurate examples and proper imports (<code>5aabcf6</code>)</li> <li>Update src/OpenMagneticsVirtualBuilder/cadquery_builder.py (<code>368e5ae</code>)</li> </ul> <p>Fixed</p> <ul> <li>Fix toroidal/concentric winding rendering and add C-core rotation (<code>cee95b8</code>)</li> <li>Fix review comments and add hidden edge support for DXF/SVG/FCMacro (<code>e92835d</code>)</li> <li>Fix test_1 and test_4 failures in CadQuery builder (<code>0458c60</code>)</li> </ul> <p>Removed</p> <ul> <li>Remove obsolete test files after full-magnetic merge (<code>1b925c7</code>)</li> </ul> <p>Other</p> <ul> <li>Initial plan (<code>ffbd016</code>)</li> <li>Mark full pipeline tests as slow, exclude from pre-push hook (<code>0ed433f</code>)</li> <li>Skip toroidal shapes in gapping tests (PyMKF incompatibility) (<code>49d89c1</code>)</li> <li>Clean up unused variables, dead code, and imports (<code>414aad9</code>)</li> <li>Restore bobbin/winding/assembly APIs and add full magnetic tests (<code>5d31767</code>)</li> <li>DRY refactoring: eliminate ~350 lines of duplicated code across engines (<code>884b9be</code>)</li> </ul>"},{"location":"changelog/#january-2026","title":"January 2026","text":"<p>Added</p> <ul> <li>Added rectangular wires (<code>df7ce91</code>)</li> <li>Added option to reduce polygons (<code>11c136e</code>)</li> <li>Added tests (<code>fe62dc0</code>)</li> </ul> <p>Other</p> <ul> <li>3D Magnetics implmented for round wires (<code>8890935</code>)</li> <li>First draft (<code>c486799</code>)</li> </ul>"},{"location":"changelog/#2025","title":"2025","text":""},{"location":"changelog/#may-2025","title":"May 2025","text":"<p>Fixed</p> <ul> <li>Fixed some issues with URs (<code>b482312</code>)</li> </ul> <p>Other</p> <ul> <li>Merge (<code>85c4ca5</code>)</li> </ul>"},{"location":"changelog/#april-2025","title":"April 2025","text":"<p>Fixed</p> <ul> <li>Fixed hole in URs (<code>1ad4b67</code>)</li> <li>Fixed some corner cases (<code>a741595</code>)</li> <li>Fixed some minor bugs in FreeCAD engine and added C shapes (<code>5cd7296</code>)</li> <li>Fixed winding window with ER (<code>3003cb4</code>)</li> <li>Fixed small bugs found by Trafolo (<code>dfd2478</code>)</li> <li>Fixed small bugs found by Trafolo (<code>9b5d784</code>)</li> </ul> <p>Other</p> <ul> <li>Version updated (<code>431e54a</code>)</li> </ul>"},{"location":"changelog/#march-2025","title":"March 2025","text":"<p>Fixed</p> <ul> <li>Fixed roundig error (<code>7407491</code>)</li> <li>Fixed roundig error (<code>bc013c0</code>)</li> </ul>"},{"location":"changelog/#february-2025","title":"February 2025","text":"<p>Added</p> <ul> <li>Added C cores (<code>48c09fb</code>)</li> </ul>"},{"location":"changelog/#january-2025","title":"January 2025","text":"<p>Fixed</p> <ul> <li>Fixed bug in cadquery engine (<code>b06e73e</code>)</li> </ul> <p>Removed</p> <ul> <li>Delete LICENSE.md (<code>e4d0cdb</code>)</li> </ul> <p>Other</p> <ul> <li>Create LICENSE (<code>e213248</code>)</li> <li>Bug fixed (<code>2f3f9ae</code>)</li> </ul>"},{"location":"changelog/#2024","title":"2024","text":""},{"location":"changelog/#december-2024","title":"December 2024","text":"<p>Added</p> <ul> <li>Added Cadquery engine (<code>e953813</code>)</li> </ul>"},{"location":"changelog/#november-2024","title":"November 2024","text":"<p>Added</p> <ul> <li>Added multipath option for linux (<code>05468d1</code>)</li> </ul>"},{"location":"changelog/#october-2024","title":"October 2024","text":"<p>Added</p> <ul> <li>Added support for PyPi (<code>30f6688</code>)</li> </ul> <p>Fixed</p> <ul> <li>Fixed default output folder (<code>6e591cb</code>)</li> </ul>"},{"location":"changelog/#september-2024","title":"September 2024","text":"<p>Changed</p> <ul> <li>Updated to FreeCAD 1.0rc2 (<code>bbfc9af</code>)</li> </ul>"},{"location":"changelog/#august-2024","title":"August 2024","text":"<p>Changed</p> <ul> <li>Improved some mdoern freecad stuff (<code>eaccb18</code>)</li> </ul> <p>Other</p> <ul> <li>All test passing with freecad-daily in Ubuntu 24 (<code>332b927</code>)</li> </ul>"},{"location":"changelog/#july-2024","title":"July 2024","text":"<p>Changed</p> <ul> <li>Updated to stable version of FreeCAD (<code>cffe97c</code>)</li> <li>Updated to latest version of PyMKF and fixed EPs position (<code>61a3288</code>)</li> </ul> <p>Other</p> <ul> <li>Set back to daily (<code>d14ee3a</code>)</li> </ul>"},{"location":"changelog/#march-2024","title":"March 2024","text":"<p>Changed</p> <ul> <li>Update README.md (<code>a671198</code>)</li> </ul>"},{"location":"changelog/#2023","title":"2023","text":""},{"location":"changelog/#october-2023","title":"October 2023","text":"<p>Added</p> <ul> <li>Added support for windows (<code>36d8b81</code>)</li> </ul>"},{"location":"changelog/#april-2023","title":"April 2023","text":"<p>Added</p> <ul> <li>Added toroids (<code>dd01242</code>)</li> </ul> <p>Fixed</p> <ul> <li>Fixed bug in ER 64 (<code>fe4a2e2</code>)</li> </ul>"},{"location":"changelog/#march-2023","title":"March 2023","text":"<p>Other</p> <ul> <li>Code cleaned a bit (<code>c0f13d5</code>)</li> </ul>"},{"location":"changelog/#february-2023","title":"February 2023","text":"<p>Changed</p> <ul> <li>Update LICENSE.md (<code>3931bb8</code>)</li> </ul> <p>Fixed</p> <ul> <li>Fixed weird case with EPX (<code>dd780a6</code>)</li> <li>Fixed bug in UR (<code>1feb690</code>)</li> </ul> <p>Other</p> <ul> <li>Uncommented tests and addedhorizontal column in EPX (<code>6598fd7</code>)</li> </ul>"},{"location":"changelog/#january-2023","title":"January 2023","text":"<p>Fixed</p> <ul> <li>Fix proejections missalignment (<code>bebce4f</code>)</li> </ul> <p>Other</p> <ul> <li>Small fix for EFDs (<code>50b96e6</code>)</li> </ul>"},{"location":"changelog/#2022","title":"2022","text":""},{"location":"changelog/#december-2022","title":"December 2022","text":"<p>Added</p> <ul> <li>Added Complete cores model (<code>42b3590</code>)</li> </ul> <p>Other</p> <ul> <li>Small correction for RMs (<code>eac20ba</code>)</li> <li>Gapping technical drawing done (<code>5e09f13</code>)</li> </ul>"},{"location":"changelog/#november-2022","title":"November 2022","text":"<p>Added</p> <ul> <li>Added tests for technical drawings (<code>5dded03</code>)</li> <li>Added manual SVG generation (<code>c806a96</code>)</li> <li>Added stability and draft of dimensions (<code>410bdc1</code>)</li> <li>Added fucntion for families and OBJ creation (<code>99d4891</code>)</li> </ul> <p>Removed</p> <ul> <li>Removed dependency on file (<code>3fa5fad</code>)</li> </ul> <p>Other</p> <ul> <li>FRemoved tempalte.svg (<code>29cdb68</code>)</li> </ul>"},{"location":"changelog/#september-2022","title":"September 2022","text":"<p>Changed</p> <ul> <li>Update README.md (<code>74de7c0</code>)</li> </ul> <p>Other</p> <ul> <li>Create LICENSE.md (<code>c17add3</code>)</li> <li>All concentric shapes added to builder (<code>be9e653</code>)</li> </ul>"},{"location":"changelog/#july-2022","title":"July 2022","text":"<p>Other</p> <ul> <li>Initial commit (<code>80583ee</code>)</li> </ul>"},{"location":"contributing/","title":"Contributing","text":"<p>Contributions to the OpenMagnetics Virtual Builder are welcome.</p>"},{"location":"contributing/#development-setup","title":"Development Setup","text":"<ol> <li> <p>Fork and clone the repository:</p> <pre><code>git clone https://github.com/YOUR_USERNAME/MVB.git\ncd MVB\n</code></pre> </li> <li> <p>Install dependencies:</p> <pre><code>pip install -e .\npip install cadquery numpy ezdxf\n</code></pre> </li> <li> <p>Clone MAS data (for tests):</p> <pre><code>git clone https://github.com/OpenMagnetics/MAS.git ../MAS\n</code></pre> </li> <li> <p>Run tests to verify setup:</p> <pre><code>python -m unittest tests.test_builder\n</code></pre> </li> </ol>"},{"location":"contributing/#code-style","title":"Code Style","text":"<ul> <li>Follow PEP 8 conventions</li> <li>Use descriptive variable names</li> <li>Add docstrings to public methods (Google style)</li> <li>Keep lines under 120 characters</li> </ul>"},{"location":"contributing/#adding-a-new-shape-family","title":"Adding a New Shape Family","text":"<ol> <li>Add the family to <code>ShapeFamily</code> enum in <code>utils.py</code></li> <li>Create the shape class in both <code>cadquery_builder.py</code> and <code>freecad_builder.py</code></li> <li>Inherit from the appropriate base class (<code>IPiece</code>, <code>E</code>, <code>P</code>, <code>U</code>, etc.)</li> <li>Implement <code>get_shape_base()</code> and <code>get_negative_winding_window()</code></li> <li>Register the shape in the engine's <code>shapers</code> dict</li> <li>Add dimension/subtype config to <code>shape_configs.py</code> if needed</li> <li>Add tests and update documentation</li> </ol>"},{"location":"contributing/#pull-request-process","title":"Pull Request Process","text":"<ol> <li>Create a feature branch from <code>main</code></li> <li>Make your changes with clear, focused commits</li> <li>Ensure all tests pass</li> <li>Update documentation if needed</li> <li>Open a pull request against <code>main</code></li> <li>Describe your changes and link any related issues</li> </ol>"},{"location":"contributing/#reporting-issues","title":"Reporting Issues","text":"<p>Please report bugs and feature requests on the GitHub Issues page.</p> <p>Include:</p> <ul> <li>Python version</li> <li>Operating system</li> <li>Steps to reproduce</li> <li>Expected vs actual behavior</li> <li>Error messages / tracebacks</li> </ul>"},{"location":"api/builder/","title":"Builder","text":"<p>The main entry point for generating magnetic component geometry.</p>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder","title":"OpenMagneticsVirtualBuilder.builder.Builder","text":"<p>Facade that delegates to a CadQuery or FreeCAD rendering engine.</p> <p>The Builder class is the main entry point for generating magnetic component geometry. It selects and wraps one of two CAD engines and exposes a uniform API for core generation, assembly, bobbin/winding creation, and technical drawing export.</p> <p>Parameters:</p> Name Type Description Default <code>engine</code> <p>Engine name, either <code>\"CadQuery\"</code> (default) or <code>\"FreeCAD\"</code>.</p> <code>'CadQuery'</code> Example <p>builder = Builder(\"CadQuery\") families = builder.get_families()</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>class Builder:\n    \"\"\"Facade that delegates to a CadQuery or FreeCAD rendering engine.\n\n    The Builder class is the main entry point for generating magnetic component\n    geometry. It selects and wraps one of two CAD engines and exposes a\n    uniform API for core generation, assembly, bobbin/winding creation,\n    and technical drawing export.\n\n    Args:\n        engine: Engine name, either ``\"CadQuery\"`` (default) or ``\"FreeCAD\"``.\n\n    Example:\n        &gt;&gt;&gt; builder = Builder(\"CadQuery\")\n        &gt;&gt;&gt; families = builder.get_families()\n    \"\"\"\n\n    def __init__(self, engine=\"CadQuery\"):\n        if engine == \"FreeCAD\":\n            import freecad_builder\n\n            self.engine = freecad_builder.FreeCADBuilder()\n        else:\n            import cadquery_builder\n\n            self.engine = cadquery_builder.CadQueryBuilder()\n\n    def factory(self, data):\n        \"\"\"Create a shape-specific builder from MAS JSON data.\n\n        Args:\n            data: Dictionary with at least a ``\"family\"`` key matching a\n                :class:`~OpenMagneticsVirtualBuilder.utils.ShapeFamily` member.\n\n        Returns:\n            A shape builder instance (e.g. ``E``, ``Pq``, ``T``) for the\n            requested family.\n        \"\"\"\n        return self.engine.factory(data)\n\n    def get_families(self):\n        \"\"\"List all available core shape families with their dimensions.\n\n        Returns:\n            Dict mapping family name (lowercase) to a dict of subtype numbers\n            and their dimension letters.\n        \"\"\"\n        return {shaper.name.lower().replace(\"_\", \" \"): self.factory({\"family\": shaper.name}).get_dimensions_and_subtypes() for shaper in self.engine.shapers}\n\n    def get_spacer(self, geometrical_data):\n        \"\"\"Generate spacer geometry for gapped cores.\n\n        Args:\n            geometrical_data: MAS geometrical description list.\n\n        Returns:\n            CadQuery/FreeCAD geometry for the spacer.\n        \"\"\"\n        return self.engine.get_spacer(geometrical_data)\n\n    def get_core(self, project_name, geometrical_description, output_path=None, save_files=True, export_files=True):\n        \"\"\"Generate full 3D core geometry from a MAS geometrical description.\n\n        Handles multi-piece cores (top/bottom halves) and applies gapping\n        (machining) when specified.\n\n        Args:\n            project_name: Base name for output files.\n            geometrical_description: List of MAS piece descriptions, each\n                containing shape data, dimensions, and optional machining.\n            output_path: Directory for output files. Defaults to ``output/``.\n            save_files: Whether to save FreeCAD project files.\n            export_files: Whether to export STEP/STL files.\n\n        Returns:\n            Tuple ``(step_path, stl_path)`` when ``export_files`` is True,\n            or a list of CadQuery/FreeCAD pieces otherwise.\n        \"\"\"\n        if output_path is None:\n            output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n        return self.engine.get_core(project_name, geometrical_description, output_path, save_files, export_files)\n\n    def get_core_gapping_technical_drawing(self, project_name, core_data, colors=None, output_path=None, save_files=True, export_files=True):\n        \"\"\"Generate a technical drawing showing core gapping details.\n\n        Produces an SVG drawing with dimension annotations for the core\n        cross-section, highlighting gap positions and lengths.\n\n        Args:\n            project_name: Base name for output files.\n            core_data: MAS core data dictionary with ``geometricalDescription``\n                and ``processedDescription`` (including ``gapping``).\n            colors: Optional dict with ``\"projection_color\"`` and\n                ``\"dimension_color\"`` hex values.\n            output_path: Directory for output files.\n            save_files: Whether to save intermediate files.\n            export_files: Whether to export final SVG.\n\n        Returns:\n            SVG string of the technical drawing.\n        \"\"\"\n        if output_path is None:\n            output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n        return self.engine.get_core_gapping_technical_drawing(project_name, core_data, colors, output_path, save_files, export_files)\n\n    def get_magnetic_assembly(self, project_name, assembly_data, output_path=None, save_files=True, export_files=True):\n        \"\"\"Generate a full magnetic assembly (core + bobbin + coil).\n\n        Args:\n            project_name: Base name for output files.\n            assembly_data: MAS assembly data containing core, coil, and\n                bobbin descriptions.\n            output_path: Directory for output files.\n            save_files: Whether to save intermediate files.\n            export_files: Whether to export STEP/STL.\n\n        Returns:\n            Tuple ``(step_path, stl_path)`` when ``export_files`` is True.\n        \"\"\"\n        if output_path is None:\n            output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n        return self.engine.get_magnetic_assembly(project_name, assembly_data, output_path, save_files, export_files)\n\n    def get_bobbin(self, bobbin_data, winding_window, name=\"Bobbin\", output_path=None, save_files=False, export_files=True):\n        \"\"\"Generate a bobbin (coil former) geometry.\n\n        Args:\n            bobbin_data: MAS bobbin description with ``processedDescription``.\n            winding_window: Dict with ``height`` and ``width`` keys (meters).\n            name: Part name for the output files.\n            output_path: Directory for output files.\n            save_files: Whether to save intermediate files.\n            export_files: Whether to export STEP/STL.\n\n        Returns:\n            Tuple ``(step_path, stl_path)`` when ``export_files`` is True.\n        \"\"\"\n        if output_path is None:\n            output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n        return self.engine.get_bobbin(bobbin_data, winding_window, name, output_path, save_files, export_files)\n\n    def get_winding(self, winding_data, bobbin_dims, name=\"Winding\", output_path=None, save_files=False, export_files=True):\n        \"\"\"Generate winding (coil) geometry.\n\n        Args:\n            winding_data: MAS winding description with wire type, turns, etc.\n            bobbin_dims: Dict with ``width`` and ``height`` keys.\n            name: Part name for output files.\n            output_path: Directory for output files.\n            save_files: Whether to save intermediate files.\n            export_files: Whether to export STEP/STL.\n\n        Returns:\n            Tuple ``(step_path, stl_path)`` when ``export_files`` is True.\n        \"\"\"\n        if output_path is None:\n            output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n        return self.engine.get_winding(winding_data, bobbin_dims, name, output_path, save_files, export_files)\n\n    def get_magnetic(self, magnetic_data, project_name=\"Magnetic\", output_path=None, export_files=True):\n        \"\"\"Create a complete 3D magnetic component from MAS data.\n\n        Parameters\n        ----------\n        magnetic_data : dict\n            MAS magnetic description dictionary containing core, coil, etc.\n            Can be either a complete MAS file (with 'magnetic' key) or just the magnetic data.\n        project_name : str\n            Name for the output files.\n        output_path : str\n            Path to save output files.\n        export_files : bool\n            If True, export STEP and STL files.\n\n        Returns\n        -------\n        Tuple of (step_path, stl_path) or list of pieces if export_files is False.\n        \"\"\"\n        if output_path is None:\n            output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n        # Handle both full MAS format and just magnetic data\n        if \"magnetic\" in magnetic_data:\n            magnetic_data = magnetic_data[\"magnetic\"]\n        return self.engine.get_magnetic(magnetic_data, project_name, output_path, export_files)\n\n    def get_svg_drawings(self, project_name, geometrical_description, **kwargs):\n        \"\"\"Generate annotated SVG drawings for a core shape.\"\"\"\n        return self.engine.get_svg_drawings(project_name, geometrical_description, **kwargs)\n\n    def get_dxf_drawings(self, project_name, geometrical_description, **kwargs):\n        \"\"\"Generate DXF drawings for a core shape.\"\"\"\n        return self.engine.get_dxf_drawings(project_name, geometrical_description, **kwargs)\n\n    def get_fcstd_sketches(self, project_name, geometrical_description, **kwargs):\n        \"\"\"Generate FreeCAD macro files for a core shape.\"\"\"\n        return self.engine.get_fcstd_sketches(project_name, geometrical_description, **kwargs)\n\n    def get_assembly_svg_drawings(self, project_name, magnetic_data, **kwargs):\n        \"\"\"Generate annotated SVG drawings for assembly or individual components.\"\"\"\n        return self.engine.get_assembly_svg_drawings(project_name, magnetic_data, **kwargs)\n\n    def get_assembly_dxf_drawings(self, project_name, magnetic_data, **kwargs):\n        \"\"\"Generate DXF drawings for assembly or individual components.\"\"\"\n        return self.engine.get_assembly_dxf_drawings(project_name, magnetic_data, **kwargs)\n\n    def get_assembly_fcstd_sketches(self, project_name, magnetic_data, **kwargs):\n        \"\"\"Generate FreeCAD macro files for assembly or individual components.\"\"\"\n        return self.engine.get_assembly_fcstd_sketches(project_name, magnetic_data, **kwargs)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.factory","title":"factory","text":"<pre><code>factory(data)\n</code></pre> <p>Create a shape-specific builder from MAS JSON data.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <p>Dictionary with at least a <code>\"family\"</code> key matching a :class:<code>~OpenMagneticsVirtualBuilder.utils.ShapeFamily</code> member.</p> required <p>Returns:</p> Type Description <p>A shape builder instance (e.g. <code>E</code>, <code>Pq</code>, <code>T</code>) for the</p> <p>requested family.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def factory(self, data):\n    \"\"\"Create a shape-specific builder from MAS JSON data.\n\n    Args:\n        data: Dictionary with at least a ``\"family\"`` key matching a\n            :class:`~OpenMagneticsVirtualBuilder.utils.ShapeFamily` member.\n\n    Returns:\n        A shape builder instance (e.g. ``E``, ``Pq``, ``T``) for the\n        requested family.\n    \"\"\"\n    return self.engine.factory(data)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_families","title":"get_families","text":"<pre><code>get_families()\n</code></pre> <p>List all available core shape families with their dimensions.</p> <p>Returns:</p> Type Description <p>Dict mapping family name (lowercase) to a dict of subtype numbers</p> <p>and their dimension letters.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_families(self):\n    \"\"\"List all available core shape families with their dimensions.\n\n    Returns:\n        Dict mapping family name (lowercase) to a dict of subtype numbers\n        and their dimension letters.\n    \"\"\"\n    return {shaper.name.lower().replace(\"_\", \" \"): self.factory({\"family\": shaper.name}).get_dimensions_and_subtypes() for shaper in self.engine.shapers}\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_spacer","title":"get_spacer","text":"<pre><code>get_spacer(geometrical_data)\n</code></pre> <p>Generate spacer geometry for gapped cores.</p> <p>Parameters:</p> Name Type Description Default <code>geometrical_data</code> <p>MAS geometrical description list.</p> required <p>Returns:</p> Type Description <p>CadQuery/FreeCAD geometry for the spacer.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_spacer(self, geometrical_data):\n    \"\"\"Generate spacer geometry for gapped cores.\n\n    Args:\n        geometrical_data: MAS geometrical description list.\n\n    Returns:\n        CadQuery/FreeCAD geometry for the spacer.\n    \"\"\"\n    return self.engine.get_spacer(geometrical_data)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_core","title":"get_core","text":"<pre><code>get_core(project_name, geometrical_description, output_path=None, save_files=True, export_files=True)\n</code></pre> <p>Generate full 3D core geometry from a MAS geometrical description.</p> <p>Handles multi-piece cores (top/bottom halves) and applies gapping (machining) when specified.</p> <p>Parameters:</p> Name Type Description Default <code>project_name</code> <p>Base name for output files.</p> required <code>geometrical_description</code> <p>List of MAS piece descriptions, each containing shape data, dimensions, and optional machining.</p> required <code>output_path</code> <p>Directory for output files. Defaults to <code>output/</code>.</p> <code>None</code> <code>save_files</code> <p>Whether to save FreeCAD project files.</p> <code>True</code> <code>export_files</code> <p>Whether to export STEP/STL files.</p> <code>True</code> <p>Returns:</p> Type Description <p>Tuple <code>(step_path, stl_path)</code> when <code>export_files</code> is True,</p> <p>or a list of CadQuery/FreeCAD pieces otherwise.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_core(self, project_name, geometrical_description, output_path=None, save_files=True, export_files=True):\n    \"\"\"Generate full 3D core geometry from a MAS geometrical description.\n\n    Handles multi-piece cores (top/bottom halves) and applies gapping\n    (machining) when specified.\n\n    Args:\n        project_name: Base name for output files.\n        geometrical_description: List of MAS piece descriptions, each\n            containing shape data, dimensions, and optional machining.\n        output_path: Directory for output files. Defaults to ``output/``.\n        save_files: Whether to save FreeCAD project files.\n        export_files: Whether to export STEP/STL files.\n\n    Returns:\n        Tuple ``(step_path, stl_path)`` when ``export_files`` is True,\n        or a list of CadQuery/FreeCAD pieces otherwise.\n    \"\"\"\n    if output_path is None:\n        output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n    return self.engine.get_core(project_name, geometrical_description, output_path, save_files, export_files)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_core_gapping_technical_drawing","title":"get_core_gapping_technical_drawing","text":"<pre><code>get_core_gapping_technical_drawing(project_name, core_data, colors=None, output_path=None, save_files=True, export_files=True)\n</code></pre> <p>Generate a technical drawing showing core gapping details.</p> <p>Produces an SVG drawing with dimension annotations for the core cross-section, highlighting gap positions and lengths.</p> <p>Parameters:</p> Name Type Description Default <code>project_name</code> <p>Base name for output files.</p> required <code>core_data</code> <p>MAS core data dictionary with <code>geometricalDescription</code> and <code>processedDescription</code> (including <code>gapping</code>).</p> required <code>colors</code> <p>Optional dict with <code>\"projection_color\"</code> and <code>\"dimension_color\"</code> hex values.</p> <code>None</code> <code>output_path</code> <p>Directory for output files.</p> <code>None</code> <code>save_files</code> <p>Whether to save intermediate files.</p> <code>True</code> <code>export_files</code> <p>Whether to export final SVG.</p> <code>True</code> <p>Returns:</p> Type Description <p>SVG string of the technical drawing.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_core_gapping_technical_drawing(self, project_name, core_data, colors=None, output_path=None, save_files=True, export_files=True):\n    \"\"\"Generate a technical drawing showing core gapping details.\n\n    Produces an SVG drawing with dimension annotations for the core\n    cross-section, highlighting gap positions and lengths.\n\n    Args:\n        project_name: Base name for output files.\n        core_data: MAS core data dictionary with ``geometricalDescription``\n            and ``processedDescription`` (including ``gapping``).\n        colors: Optional dict with ``\"projection_color\"`` and\n            ``\"dimension_color\"`` hex values.\n        output_path: Directory for output files.\n        save_files: Whether to save intermediate files.\n        export_files: Whether to export final SVG.\n\n    Returns:\n        SVG string of the technical drawing.\n    \"\"\"\n    if output_path is None:\n        output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n    return self.engine.get_core_gapping_technical_drawing(project_name, core_data, colors, output_path, save_files, export_files)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_magnetic_assembly","title":"get_magnetic_assembly","text":"<pre><code>get_magnetic_assembly(project_name, assembly_data, output_path=None, save_files=True, export_files=True)\n</code></pre> <p>Generate a full magnetic assembly (core + bobbin + coil).</p> <p>Parameters:</p> Name Type Description Default <code>project_name</code> <p>Base name for output files.</p> required <code>assembly_data</code> <p>MAS assembly data containing core, coil, and bobbin descriptions.</p> required <code>output_path</code> <p>Directory for output files.</p> <code>None</code> <code>save_files</code> <p>Whether to save intermediate files.</p> <code>True</code> <code>export_files</code> <p>Whether to export STEP/STL.</p> <code>True</code> <p>Returns:</p> Type Description <p>Tuple <code>(step_path, stl_path)</code> when <code>export_files</code> is True.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_magnetic_assembly(self, project_name, assembly_data, output_path=None, save_files=True, export_files=True):\n    \"\"\"Generate a full magnetic assembly (core + bobbin + coil).\n\n    Args:\n        project_name: Base name for output files.\n        assembly_data: MAS assembly data containing core, coil, and\n            bobbin descriptions.\n        output_path: Directory for output files.\n        save_files: Whether to save intermediate files.\n        export_files: Whether to export STEP/STL.\n\n    Returns:\n        Tuple ``(step_path, stl_path)`` when ``export_files`` is True.\n    \"\"\"\n    if output_path is None:\n        output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n    return self.engine.get_magnetic_assembly(project_name, assembly_data, output_path, save_files, export_files)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_bobbin","title":"get_bobbin","text":"<pre><code>get_bobbin(bobbin_data, winding_window, name='Bobbin', output_path=None, save_files=False, export_files=True)\n</code></pre> <p>Generate a bobbin (coil former) geometry.</p> <p>Parameters:</p> Name Type Description Default <code>bobbin_data</code> <p>MAS bobbin description with <code>processedDescription</code>.</p> required <code>winding_window</code> <p>Dict with <code>height</code> and <code>width</code> keys (meters).</p> required <code>name</code> <p>Part name for the output files.</p> <code>'Bobbin'</code> <code>output_path</code> <p>Directory for output files.</p> <code>None</code> <code>save_files</code> <p>Whether to save intermediate files.</p> <code>False</code> <code>export_files</code> <p>Whether to export STEP/STL.</p> <code>True</code> <p>Returns:</p> Type Description <p>Tuple <code>(step_path, stl_path)</code> when <code>export_files</code> is True.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_bobbin(self, bobbin_data, winding_window, name=\"Bobbin\", output_path=None, save_files=False, export_files=True):\n    \"\"\"Generate a bobbin (coil former) geometry.\n\n    Args:\n        bobbin_data: MAS bobbin description with ``processedDescription``.\n        winding_window: Dict with ``height`` and ``width`` keys (meters).\n        name: Part name for the output files.\n        output_path: Directory for output files.\n        save_files: Whether to save intermediate files.\n        export_files: Whether to export STEP/STL.\n\n    Returns:\n        Tuple ``(step_path, stl_path)`` when ``export_files`` is True.\n    \"\"\"\n    if output_path is None:\n        output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n    return self.engine.get_bobbin(bobbin_data, winding_window, name, output_path, save_files, export_files)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_winding","title":"get_winding","text":"<pre><code>get_winding(winding_data, bobbin_dims, name='Winding', output_path=None, save_files=False, export_files=True)\n</code></pre> <p>Generate winding (coil) geometry.</p> <p>Parameters:</p> Name Type Description Default <code>winding_data</code> <p>MAS winding description with wire type, turns, etc.</p> required <code>bobbin_dims</code> <p>Dict with <code>width</code> and <code>height</code> keys.</p> required <code>name</code> <p>Part name for output files.</p> <code>'Winding'</code> <code>output_path</code> <p>Directory for output files.</p> <code>None</code> <code>save_files</code> <p>Whether to save intermediate files.</p> <code>False</code> <code>export_files</code> <p>Whether to export STEP/STL.</p> <code>True</code> <p>Returns:</p> Type Description <p>Tuple <code>(step_path, stl_path)</code> when <code>export_files</code> is True.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_winding(self, winding_data, bobbin_dims, name=\"Winding\", output_path=None, save_files=False, export_files=True):\n    \"\"\"Generate winding (coil) geometry.\n\n    Args:\n        winding_data: MAS winding description with wire type, turns, etc.\n        bobbin_dims: Dict with ``width`` and ``height`` keys.\n        name: Part name for output files.\n        output_path: Directory for output files.\n        save_files: Whether to save intermediate files.\n        export_files: Whether to export STEP/STL.\n\n    Returns:\n        Tuple ``(step_path, stl_path)`` when ``export_files`` is True.\n    \"\"\"\n    if output_path is None:\n        output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n    return self.engine.get_winding(winding_data, bobbin_dims, name, output_path, save_files, export_files)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_magnetic","title":"get_magnetic","text":"<pre><code>get_magnetic(magnetic_data, project_name='Magnetic', output_path=None, export_files=True)\n</code></pre> <p>Create a complete 3D magnetic component from MAS data.</p>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_magnetic--parameters","title":"Parameters","text":"<p>magnetic_data : dict     MAS magnetic description dictionary containing core, coil, etc.     Can be either a complete MAS file (with 'magnetic' key) or just the magnetic data. project_name : str     Name for the output files. output_path : str     Path to save output files. export_files : bool     If True, export STEP and STL files.</p>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_magnetic--returns","title":"Returns","text":"<p>Tuple of (step_path, stl_path) or list of pieces if export_files is False.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_magnetic(self, magnetic_data, project_name=\"Magnetic\", output_path=None, export_files=True):\n    \"\"\"Create a complete 3D magnetic component from MAS data.\n\n    Parameters\n    ----------\n    magnetic_data : dict\n        MAS magnetic description dictionary containing core, coil, etc.\n        Can be either a complete MAS file (with 'magnetic' key) or just the magnetic data.\n    project_name : str\n        Name for the output files.\n    output_path : str\n        Path to save output files.\n    export_files : bool\n        If True, export STEP and STL files.\n\n    Returns\n    -------\n    Tuple of (step_path, stl_path) or list of pieces if export_files is False.\n    \"\"\"\n    if output_path is None:\n        output_path = f\"{os.path.dirname(os.path.abspath(__file__))}/../../output/\"\n    # Handle both full MAS format and just magnetic data\n    if \"magnetic\" in magnetic_data:\n        magnetic_data = magnetic_data[\"magnetic\"]\n    return self.engine.get_magnetic(magnetic_data, project_name, output_path, export_files)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_svg_drawings","title":"get_svg_drawings","text":"<pre><code>get_svg_drawings(project_name, geometrical_description, **kwargs)\n</code></pre> <p>Generate annotated SVG drawings for a core shape.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_svg_drawings(self, project_name, geometrical_description, **kwargs):\n    \"\"\"Generate annotated SVG drawings for a core shape.\"\"\"\n    return self.engine.get_svg_drawings(project_name, geometrical_description, **kwargs)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_dxf_drawings","title":"get_dxf_drawings","text":"<pre><code>get_dxf_drawings(project_name, geometrical_description, **kwargs)\n</code></pre> <p>Generate DXF drawings for a core shape.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_dxf_drawings(self, project_name, geometrical_description, **kwargs):\n    \"\"\"Generate DXF drawings for a core shape.\"\"\"\n    return self.engine.get_dxf_drawings(project_name, geometrical_description, **kwargs)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_fcstd_sketches","title":"get_fcstd_sketches","text":"<pre><code>get_fcstd_sketches(project_name, geometrical_description, **kwargs)\n</code></pre> <p>Generate FreeCAD macro files for a core shape.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_fcstd_sketches(self, project_name, geometrical_description, **kwargs):\n    \"\"\"Generate FreeCAD macro files for a core shape.\"\"\"\n    return self.engine.get_fcstd_sketches(project_name, geometrical_description, **kwargs)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_assembly_svg_drawings","title":"get_assembly_svg_drawings","text":"<pre><code>get_assembly_svg_drawings(project_name, magnetic_data, **kwargs)\n</code></pre> <p>Generate annotated SVG drawings for assembly or individual components.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_assembly_svg_drawings(self, project_name, magnetic_data, **kwargs):\n    \"\"\"Generate annotated SVG drawings for assembly or individual components.\"\"\"\n    return self.engine.get_assembly_svg_drawings(project_name, magnetic_data, **kwargs)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_assembly_dxf_drawings","title":"get_assembly_dxf_drawings","text":"<pre><code>get_assembly_dxf_drawings(project_name, magnetic_data, **kwargs)\n</code></pre> <p>Generate DXF drawings for assembly or individual components.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_assembly_dxf_drawings(self, project_name, magnetic_data, **kwargs):\n    \"\"\"Generate DXF drawings for assembly or individual components.\"\"\"\n    return self.engine.get_assembly_dxf_drawings(project_name, magnetic_data, **kwargs)\n</code></pre>"},{"location":"api/builder/#OpenMagneticsVirtualBuilder.builder.Builder.get_assembly_fcstd_sketches","title":"get_assembly_fcstd_sketches","text":"<pre><code>get_assembly_fcstd_sketches(project_name, magnetic_data, **kwargs)\n</code></pre> <p>Generate FreeCAD macro files for assembly or individual components.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/builder.py</code> <pre><code>def get_assembly_fcstd_sketches(self, project_name, magnetic_data, **kwargs):\n    \"\"\"Generate FreeCAD macro files for assembly or individual components.\"\"\"\n    return self.engine.get_assembly_fcstd_sketches(project_name, magnetic_data, **kwargs)\n</code></pre>"},{"location":"api/cadquery-builder/","title":"CadQuery Builder","text":"<p>The CadQuery rendering engine. Contains all shape classes, bobbin/winding builders, and export logic.</p>"},{"location":"api/cadquery-builder/#module-overview","title":"Module Overview","text":""},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder","title":"OpenMagneticsVirtualBuilder.cadquery_builder","text":"<p>CadQuery rendering engine for OpenMagneticsVirtualBuilder.</p> <p>Implements all 21 core shape families, bobbin, and winding geometry using the CadQuery Python CAD scripting library.  This engine requires no system CAD installation and is suitable for headless / CI environments.</p> <p>Shape classes are nested inside :class:<code>CadQueryBuilder</code> and follow the EN 60205 naming convention.</p>"},{"location":"api/cadquery-builder/#main-builder-class","title":"Main Builder Class","text":""},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder","title":"OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder","text":"<p>               Bases: <code>BuilderBase</code></p> <p>Builder for 3D magnetic component geometry using CadQuery.</p> <p>This class creates 3D geometry for magnetic components including: - Core shapes (E, ETD, PQ, RM, toroidal, etc.) - Coil turns (concentric and toroidal winding styles) - Bobbins</p> <p>Coordinate System (MAS to CadQuery mapping): - For concentric cores (E, PQ, RM, etc.):     - X axis: Core depth direction (perpendicular to winding window)     - Y axis: Core width direction (radial, distance from central column)     - Z axis: Core height direction (along core axis, vertical)     - MAS coordinates[0] (radial) -&gt; Y position     - MAS coordinates[1] (height) -&gt; Z position</p> <ul> <li>For toroidal cores:<ul> <li>Y axis: Core axis (toroid revolves around Y)</li> <li>X axis: Radial direction (negative X = inside the donut hole)</li> <li>Z axis: Tangential direction (along circumference at Y=0)</li> <li>MAS coordinates[0] (radial) -&gt; distance from Y axis</li> <li>MAS coordinates[1] (angular) -&gt; rotation angle around Y axis</li> </ul> </li> </ul> <p>Units: - All MAS input values are in meters - Internal geometry is built in millimeters for precision - Output is scaled back to meters before export</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_magnetic_assembly","title":"get_magnetic_assembly","text":"<pre><code>get_magnetic_assembly(project_name, assembly_data, output_path=None, save_files=True, export_files=True)\n</code></pre> <p>Build a magnetic assembly from core, bobbin, and winding data.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_magnetic_assembly--parameters","title":"Parameters","text":"<p>project_name : str     Name for the output files. assembly_data : dict     Dictionary with optional keys: 'core', 'bobbin', 'windings', 'coil'. output_path : str     Directory for output files. save_files : bool     Whether to save intermediate files. export_files : bool     Whether to export STEP/STL files.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_svg_drawings","title":"get_svg_drawings","text":"<pre><code>get_svg_drawings(project_name, geometrical_description, planes=None, view_types=None, colors=None, output_path=None, save_files=True, slice_offsets=None)\n</code></pre> <p>Generate annotated SVG drawings for a core shape.</p> <p>Parameters:</p> Name Type Description Default <code>project_name</code> <p>Name for output files.</p> required <code>geometrical_description</code> <p>List of geometrical part descriptions.</p> required <code>planes</code> <p>List of ViewPlane values (default: all three).</p> <code>None</code> <code>view_types</code> <p>List of ViewType values (default: PROJECTION only).</p> <code>None</code> <code>colors</code> <p>Dict with 'projection_color' and 'dimension_color'.</p> <code>None</code> <code>output_path</code> <p>Directory for output files.</p> <code>None</code> <code>save_files</code> <p>Whether to write SVG files to disk.</p> <code>True</code> <code>slice_offsets</code> <p>Optional dict overriding per-plane slice offsets.</p> <code>None</code> <p>Returns:</p> Type Description <p>Dict of {key: svg_string} where key is e.g. 'xy_projection'.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_dxf_drawings","title":"get_dxf_drawings","text":"<pre><code>get_dxf_drawings(project_name, geometrical_description, planes=None, view_types=None, colors=None, output_path=None, slice_offsets=None)\n</code></pre> <p>Generate DXF drawings for a core shape.</p> <p>Returns:</p> Type Description <p>Dict of {key: filepath} where key is e.g. 'xy_projection'.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_fcstd_sketches","title":"get_fcstd_sketches","text":"<pre><code>get_fcstd_sketches(project_name, geometrical_description, planes=None, view_types=None, output_path=None, slice_offsets=None)\n</code></pre> <p>Generate FreeCAD macro files (.FCMacro) for a core shape.</p> <p>Returns:</p> Type Description <p>Dict of {key: filepath} where key is e.g. 'xy_projection'.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_assembly_svg_drawings","title":"get_assembly_svg_drawings","text":"<pre><code>get_assembly_svg_drawings(project_name, magnetic_data, planes=None, view_types=None, colors=None, output_path=None, save_files=True, slice_offsets=None, components=None)\n</code></pre> <p>Generate annotated SVG drawings for an assembly or individual components.</p> <p>Parameters:</p> Name Type Description Default <code>project_name</code> <p>Name for output files.</p> required <code>magnetic_data</code> <p>MAS magnetic data dict.</p> required <code>planes</code> <p>List of ViewPlane values.</p> <code>None</code> <code>view_types</code> <p>List of ViewType values.</p> <code>None</code> <code>colors</code> <p>Color config dict.</p> <code>None</code> <code>output_path</code> <p>Directory for output files.</p> <code>None</code> <code>save_files</code> <p>Whether to write SVG files to disk.</p> <code>True</code> <code>slice_offsets</code> <p>Optional per-plane slice offsets.</p> <code>None</code> <code>components</code> <p>List of components to draw: 'assembly', 'core', 'bobbin', 'winding'.        Default is ['assembly'].</p> <code>None</code> <p>Returns:</p> Type Description <p>Dict of {component_key: svg_string}.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_assembly_dxf_drawings","title":"get_assembly_dxf_drawings","text":"<pre><code>get_assembly_dxf_drawings(project_name, magnetic_data, planes=None, view_types=None, colors=None, output_path=None, slice_offsets=None, components=None)\n</code></pre> <p>Generate DXF drawings for assembly or individual components.</p> <p>Returns:</p> Type Description <p>Dict of {component_key: filepath}.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_assembly_fcstd_sketches","title":"get_assembly_fcstd_sketches","text":"<pre><code>get_assembly_fcstd_sketches(project_name, magnetic_data, planes=None, view_types=None, output_path=None, slice_offsets=None, components=None)\n</code></pre> <p>Generate FreeCAD macro files for assembly or individual components.</p> <p>Returns:</p> Type Description <p>Dict of {component_key: filepath}.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_turn","title":"get_turn","text":"<pre><code>get_turn(turn_description: TurnDescription, wire_description: WireDescription, bobbin_description: BobbinProcessedDescription, is_toroidal: bool = False) -&gt; cq.Workplane\n</code></pre> <p>Create a single turn geometry.</p> <p>Parameters:</p> Name Type Description Default <code>turn_description</code> <code>TurnDescription</code> <p>Turn parameters (coordinates, winding, etc.)</p> required <code>wire_description</code> <code>WireDescription</code> <p>Wire parameters (type, diameter, etc.)</p> required <code>bobbin_description</code> <code>BobbinProcessedDescription</code> <p>Bobbin parameters</p> required <code>is_toroidal</code> <code>bool</code> <p>If True, create toroidal turn; otherwise concentric turn</p> <code>False</code> <p>Returns:</p> Type Description <code>Workplane</code> <p>CadQuery Workplane with the turn geometry</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.CadQueryBuilder.get_magnetic","title":"get_magnetic","text":"<pre><code>get_magnetic(magnetic_data: dict, project_name: str = 'Magnetic', output_path: str = None, export_files: bool = True)\n</code></pre> <p>Build complete magnetic assembly (core + coil).</p> <p>Parameters:</p> Name Type Description Default <code>magnetic_data</code> <code>dict</code> <p>MAS format magnetic data with 'core' and 'coil' keys</p> required <code>project_name</code> <code>str</code> <p>Name for the output files</p> <code>'Magnetic'</code> <code>output_path</code> <code>str</code> <p>Directory for output files</p> <code>None</code> <code>export_files</code> <code>bool</code> <p>Whether to export STEP/STL files</p> <code>True</code> <p>Returns:</p> Type Description <p>Tuple of (step_path, stl_path) or compound if export_files is False</p>"},{"location":"api/cadquery-builder/#enums","title":"Enums","text":""},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.WireType","title":"OpenMagneticsVirtualBuilder.cadquery_builder.WireType","text":"<p>               Bases: <code>Enum</code></p> <p>Wire types supported.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.ColumnShape","title":"OpenMagneticsVirtualBuilder.cadquery_builder.ColumnShape","text":"<p>               Bases: <code>Enum</code></p> <p>Bobbin column shapes.</p>"},{"location":"api/cadquery-builder/#data-classes","title":"Data Classes","text":""},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.WireDescription","title":"OpenMagneticsVirtualBuilder.cadquery_builder.WireDescription  <code>dataclass</code>","text":"<p>Description of a wire.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.TurnDescription","title":"OpenMagneticsVirtualBuilder.cadquery_builder.TurnDescription  <code>dataclass</code>","text":"<p>Description of a single turn.</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.BobbinProcessedDescription","title":"OpenMagneticsVirtualBuilder.cadquery_builder.BobbinProcessedDescription  <code>dataclass</code>","text":"<p>Processed bobbin description.</p>"},{"location":"api/cadquery-builder/#utility-functions","title":"Utility Functions","text":""},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.set_tessellation_quality","title":"OpenMagneticsVirtualBuilder.cadquery_builder.set_tessellation_quality","text":"<pre><code>set_tessellation_quality(segments_per_circle: int = 20, linear_tolerance: float = 0.1)\n</code></pre> <p>Configure the tessellation quality for STL export.</p> <p>Parameters:</p> Name Type Description Default <code>segments_per_circle</code> <code>int</code> <p>Number of segments per full circle (default: 20). - 8-12: Very coarse, good for previews - 16-24: Medium quality, good balance - 32-48: High quality, smooth curves - 64+: Very high quality, large files</p> <code>20</code> <code>linear_tolerance</code> <code>float</code> <p>Maximum chord deviation in mm (default: 0.1). Smaller values = more accurate but more polygons.</p> <code>0.1</code> Example Source code in <code>src/OpenMagneticsVirtualBuilder/cadquery_builder.py</code> <pre><code>def set_tessellation_quality(segments_per_circle: int = 20, linear_tolerance: float = 0.1):\n    \"\"\"Configure the tessellation quality for STL export.\n\n    Args:\n        segments_per_circle: Number of segments per full circle (default: 20).\n            - 8-12: Very coarse, good for previews\n            - 16-24: Medium quality, good balance\n            - 32-48: High quality, smooth curves\n            - 64+: Very high quality, large files\n        linear_tolerance: Maximum chord deviation in mm (default: 0.1).\n            Smaller values = more accurate but more polygons.\n\n    Example:\n        # Coarse quality for fast previews\n        set_tessellation_quality(segments_per_circle=12)\n\n        # High quality for final renders\n        set_tessellation_quality(segments_per_circle=48, linear_tolerance=0.01)\n    \"\"\"\n    global TESSELLATION_SEGMENTS_PER_CIRCLE, TESSELLATION_LINEAR_TOLERANCE\n    TESSELLATION_SEGMENTS_PER_CIRCLE = segments_per_circle\n    TESSELLATION_LINEAR_TOLERANCE = linear_tolerance\n</code></pre>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.set_tessellation_quality--coarse-quality-for-fast-previews","title":"Coarse quality for fast previews","text":"<p>set_tessellation_quality(segments_per_circle=12)</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.set_tessellation_quality--high-quality-for-final-renders","title":"High quality for final renders","text":"<p>set_tessellation_quality(segments_per_circle=48, linear_tolerance=0.01)</p>"},{"location":"api/cadquery-builder/#OpenMagneticsVirtualBuilder.cadquery_builder.resolve_dimensional_value","title":"OpenMagneticsVirtualBuilder.cadquery_builder.resolve_dimensional_value","text":"<pre><code>resolve_dimensional_value(value: Any) -&gt; float\n</code></pre> <p>Extract numeric value from dimensional data (handles dict with 'nominal' or plain value).</p> Source code in <code>src/OpenMagneticsVirtualBuilder/cadquery_builder.py</code> <pre><code>def resolve_dimensional_value(value: Any) -&gt; float:\n    \"\"\"Extract numeric value from dimensional data (handles dict with 'nominal' or plain value).\"\"\"\n    if value is None:\n        return 0.0\n    if isinstance(value, dict):\n        return value.get(\"nominal\", value.get(\"minimum\", value.get(\"maximum\", 0.0)))\n    return float(value)\n</code></pre>"},{"location":"api/drawing-2d/","title":"2D Drawings","text":"<p>Multi-format (SVG, DXF, FCMacro) 2D technical drawing generation with dimension annotations for magnetic core shapes.</p>"},{"location":"api/drawing-2d/#module","title":"Module","text":""},{"location":"api/drawing-2d/#OpenMagneticsVirtualBuilder.drawing_2d","title":"OpenMagneticsVirtualBuilder.drawing_2d","text":"<p>2D Drawing Generation Module for OpenMagneticsVirtualBuilder.</p> <p>Provides multi-format (SVG, DXF, FCMacro) 2D technical drawings with dimension annotations for magnetic core shapes.</p>"},{"location":"api/drawing-2d/#enums","title":"Enums","text":""},{"location":"api/drawing-2d/#OpenMagneticsVirtualBuilder.drawing_2d.ViewPlane","title":"OpenMagneticsVirtualBuilder.drawing_2d.ViewPlane","text":"<p>               Bases: <code>Enum</code></p>"},{"location":"api/drawing-2d/#OpenMagneticsVirtualBuilder.drawing_2d.ViewType","title":"OpenMagneticsVirtualBuilder.drawing_2d.ViewType","text":"<p>               Bases: <code>Enum</code></p>"},{"location":"api/drawing-2d/#data-classes","title":"Data Classes","text":""},{"location":"api/drawing-2d/#OpenMagneticsVirtualBuilder.drawing_2d.DimensionAnnotation","title":"OpenMagneticsVirtualBuilder.drawing_2d.DimensionAnnotation  <code>dataclass</code>","text":""},{"location":"api/drawing-2d/#OpenMagneticsVirtualBuilder.drawing_2d.DrawingView","title":"OpenMagneticsVirtualBuilder.drawing_2d.DrawingView  <code>dataclass</code>","text":""},{"location":"api/drawing-2d/#functions","title":"Functions","text":""},{"location":"api/drawing-2d/#OpenMagneticsVirtualBuilder.drawing_2d.cross_section_at_plane","title":"OpenMagneticsVirtualBuilder.drawing_2d.cross_section_at_plane","text":"<pre><code>cross_section_at_plane(shape, plane: ViewPlane, offset: float = 0.0)\n</code></pre> <p>Slice a 3D shape at the given plane and offset.</p> <p>Uses OCP BRepAlgoAPI_Section to create a cross-section wire.</p> <p>Parameters:</p> Name Type Description Default <code>shape</code> <p>CadQuery shape/compound to slice.</p> required <code>plane</code> <code>ViewPlane</code> <p>Which principal plane to slice on.</p> required <code>offset</code> <code>float</code> <p>Offset from origin along the plane normal.</p> <code>0.0</code> <p>Returns:</p> Type Description <p>A CadQuery Compound of the section edges, or None on failure.</p>"},{"location":"api/drawing-2d/#OpenMagneticsVirtualBuilder.drawing_2d.create_dimension_svg","title":"OpenMagneticsVirtualBuilder.drawing_2d.create_dimension_svg","text":"<pre><code>create_dimension_svg(starting_coordinates, ending_coordinates, dimension_type, dimension_label, view_x, view_y, colors, dimension_font_size=20, dimension_line_thickness=1, label_offset=0, label_alignment=0, arrow_size=6, arrow_length=15)\n</code></pre> <p>Create SVG markup for a dimension annotation.</p> <p>This is a pure-SVG implementation ported from FreeCADBuilder._create_dimension_svg.</p> <p>Parameters:</p> Name Type Description Default <code>starting_coordinates</code> <p>[x, y] start point in shape coordinates.</p> required <code>ending_coordinates</code> <p>[x, y] end point in shape coordinates.</p> required <code>dimension_type</code> <p>'DistanceX' or 'DistanceY'.</p> required <code>dimension_label</code> <p>Text label for the dimension.</p> required <code>view_x</code> <p>X origin of the view in SVG space.</p> required <code>view_y</code> <p>Y origin of the view in SVG space.</p> required <code>colors</code> <p>Dict with 'dimension_color' key.</p> required <code>dimension_font_size</code> <p>Font size for labels.</p> <code>20</code> <code>dimension_line_thickness</code> <p>Stroke width for dimension lines.</p> <code>1</code> <code>label_offset</code> <p>Offset for placing the dimension line away from the shape.</p> <code>0</code> <code>label_alignment</code> <p>Additional alignment offset for the label text.</p> <code>0</code> <code>arrow_size</code> <p>Width of arrowhead.</p> <code>6</code> <code>arrow_length</code> <p>Length of arrowhead.</p> <code>15</code> <p>Returns:</p> Type Description <p>SVG string for the dimension annotation.</p>"},{"location":"api/freecad-builder/","title":"FreeCAD Builder","text":"<p>The FreeCAD rendering engine. Requires a system FreeCAD installation.</p> <p>Not available for auto-generation</p> <p>The FreeCAD engine requires a FreeCAD system installation that is not available in CI environments. This page documents the API manually.</p>"},{"location":"api/freecad-builder/#freecadbuilder","title":"FreeCADBuilder","text":"<pre><code>from OpenMagneticsVirtualBuilder.freecad_builder import FreeCADBuilder\n</code></pre> <p>The <code>FreeCADBuilder</code> class mirrors the <code>CadQueryBuilder</code> API. It inherits from <code>BuilderBase</code> and registers the same set of shape families.</p>"},{"location":"api/freecad-builder/#path-discovery","title":"Path Discovery","text":"<p>On instantiation, <code>FreeCADBuilder</code> searches for a FreeCAD installation:</p> Platform Search Paths Linux <code>/usr/lib/freecad/lib</code>, <code>/usr/lib/freecad-daily/lib</code> Windows <code>%LOCALAPPDATA%\\Programs\\FreeCAD 1.0\\bin</code>, <code>%LOCALAPPDATA%\\Programs\\FreeCAD 0.21\\bin</code>, <code>%ProgramFiles%\\FreeCAD 1.0\\bin</code>"},{"location":"api/freecad-builder/#public-methods","title":"Public Methods","text":""},{"location":"api/freecad-builder/#get_coreproject_name-geometrical_description-output_path-save_files-export_files","title":"<code>get_core(project_name, geometrical_description, output_path, save_files, export_files)</code>","text":"<p>Generate full 3D core geometry. Identical signature to <code>Builder.get_core()</code>.</p> <p>Returns: <code>(step_path, stl_path)</code> or list of FreeCAD shapes.</p>"},{"location":"api/freecad-builder/#get_core_gapping_technical_drawingproject_name-core_data-colors-output_path-save_files-export_files","title":"<code>get_core_gapping_technical_drawing(project_name, core_data, colors, output_path, save_files, export_files)</code>","text":"<p>Generate SVG technical drawing with dimension annotations and gapping details.</p> <p>Returns: SVG string.</p>"},{"location":"api/freecad-builder/#get_magnetic_assemblyproject_name-assembly_data-output_path-save_files-export_files","title":"<code>get_magnetic_assembly(project_name, assembly_data, output_path, save_files, export_files)</code>","text":"<p>Generate a full magnetic assembly (core + bobbin + coil).</p> <p>Returns: <code>(step_path, stl_path)</code>.</p>"},{"location":"api/freecad-builder/#get_bobbinbobbin_data-winding_window-name-output_path-save_files-export_files","title":"<code>get_bobbin(bobbin_data, winding_window, name, output_path, save_files, export_files)</code>","text":"<p>Generate bobbin geometry.</p> <p>Returns: <code>(step_path, stl_path)</code>.</p>"},{"location":"api/freecad-builder/#get_windingwinding_data-bobbin_dims-name-output_path-save_files-export_files","title":"<code>get_winding(winding_data, bobbin_dims, name, output_path, save_files, export_files)</code>","text":"<p>Generate winding geometry.</p> <p>Returns: <code>(step_path, stl_path)</code>.</p>"},{"location":"api/freecad-builder/#get_spacergeometrical_data","title":"<code>get_spacer(geometrical_data)</code>","text":"<p>Generate spacer geometry for gapped cores.</p>"},{"location":"api/freecad-builder/#shape-classes","title":"Shape Classes","text":"<p>The FreeCAD engine contains the same nested shape classes as the CadQuery engine (<code>IPiece</code>, <code>E</code>, <code>P</code>, <code>U</code>, <code>T</code>, <code>C</code>, etc.) with identical inheritance hierarchies. See Shape Hierarchy for the full class tree.</p>"},{"location":"api/freecad-builder/#output-formats","title":"Output Formats","text":"<p>In addition to STEP and STL, the FreeCAD engine supports:</p> <ul> <li>OBJ mesh export</li> <li>FCStd FreeCAD project files (when <code>save_files=True</code>)</li> <li>SVG technical drawings with dimension annotations</li> </ul>"},{"location":"api/magnetic-builder/","title":"Magnetic Builder","text":"<p>Backward-compatibility module that re-exports magnetic building functionality from <code>cadquery_builder.py</code>.</p>"},{"location":"api/magnetic-builder/#OpenMagneticsVirtualBuilder.magnetic_builder","title":"OpenMagneticsVirtualBuilder.magnetic_builder","text":"<p>Magnetic Builder Module for OpenMagnetics Virtual Builder (MVB)</p> <p>This module provides backward compatibility by re-exporting the magnetic building functionality from cadquery_builder.py.</p> <p>All bobbin, coil, and magnetic building functionality is now integrated into the main CadQueryBuilder class for a unified API.</p> <p>The hierarchical structure is: - Turn: single wire loop around core (get_turn) - Layer: multiple turns stacked vertically (get_layer) - Section: multiple layers stacked radially (get_section) - Winding: complete winding - primary, secondary, etc. (get_winding) - Coil: all windings combined (get_coil) - Magnetic: complete assembly - core + bobbin + coil (get_magnetic)</p>"},{"location":"api/magnetic-builder/#aliases","title":"Aliases","text":"<p>The following aliases are provided for backward compatibility:</p> Alias Target <code>CadQueryBobbinBuilder</code> <code>CadQueryBuilder</code> <code>CadQueryCoilBuilder</code> <code>CadQueryBuilder</code> <code>CadQueryMagneticBuilder</code> <code>CadQueryBuilder</code> <p>All bobbin, coil, and magnetic building functionality is now integrated into the main <code>CadQueryBuilder</code> class. See CadQuery Builder for the full API.</p>"},{"location":"api/shape-configs/","title":"Shape Configs","text":"<p>Shared dimension and subtype configuration tables used by both rendering engines.</p>"},{"location":"api/shape-configs/#OpenMagneticsVirtualBuilder.shape_configs","title":"OpenMagneticsVirtualBuilder.shape_configs","text":"<p>Shared shape dimension and subtype configurations for both FreeCAD and CadQuery engines.</p>"},{"location":"api/utils/","title":"Utilities","text":"<p>Core utility types and helper functions.</p>"},{"location":"api/utils/#shapefamily-enum","title":"ShapeFamily Enum","text":""},{"location":"api/utils/#OpenMagneticsVirtualBuilder.utils.ShapeFamily","title":"OpenMagneticsVirtualBuilder.utils.ShapeFamily","text":"<p>               Bases: <code>Enum</code></p> <p>Enumeration of all supported magnetic core shape families.</p> <p>Each member corresponds to a core geometry following EN 60205 naming.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/utils.py</code> <pre><code>class ShapeFamily(enum.Enum, metaclass=Meta):\n    \"\"\"Enumeration of all supported magnetic core shape families.\n\n    Each member corresponds to a core geometry following EN 60205 naming.\n    \"\"\"\n\n    ETD = enum.auto()\n    ER = enum.auto()\n    EP = enum.auto()\n    EPX = enum.auto()\n    PQ = enum.auto()\n    E = enum.auto()\n    PM = enum.auto()\n    P = enum.auto()\n    RM = enum.auto()\n    PLANAR_ER = enum.auto()\n    EFD = enum.auto()\n    U = enum.auto()\n    EQ = enum.auto()\n    PLANAR_E = enum.auto()\n    PLANAR_EL = enum.auto()\n    EC = enum.auto()\n    UR = enum.auto()\n    UT = enum.auto()\n    LP = enum.auto()\n    T = enum.auto()\n    C = enum.auto()\n</code></pre>"},{"location":"api/utils/#builderbase","title":"BuilderBase","text":""},{"location":"api/utils/#OpenMagneticsVirtualBuilder.utils.BuilderBase","title":"OpenMagneticsVirtualBuilder.utils.BuilderBase","text":"<p>Shared base for FreeCADBuilder and CadQueryBuilder with common factory/families logic.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/utils.py</code> <pre><code>class BuilderBase:\n    \"\"\"Shared base for FreeCADBuilder and CadQueryBuilder with common factory/families logic.\"\"\"\n\n    def factory(self, data):\n        \"\"\"Look up the shape builder for the given family name.\n\n        Args:\n            data: Dict with a ``\"family\"`` key.\n\n        Returns:\n            Shape builder instance from ``self.shapers``.\n        \"\"\"\n        family = ShapeFamily[data[\"family\"].upper().replace(\" \", \"_\")]\n        return self.shapers[family]\n\n    def get_families(self):\n        \"\"\"Return dimensions and subtypes for every registered shape family.\"\"\"\n        return {shaper.name.lower().replace(\"_\", \" \"): self.factory({\"family\": shaper.name}).get_dimensions_and_subtypes() for shaper in self.shapers}\n</code></pre>"},{"location":"api/utils/#OpenMagneticsVirtualBuilder.utils.BuilderBase.factory","title":"factory","text":"<pre><code>factory(data)\n</code></pre> <p>Look up the shape builder for the given family name.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <p>Dict with a <code>\"family\"</code> key.</p> required <p>Returns:</p> Type Description <p>Shape builder instance from <code>self.shapers</code>.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/utils.py</code> <pre><code>def factory(self, data):\n    \"\"\"Look up the shape builder for the given family name.\n\n    Args:\n        data: Dict with a ``\"family\"`` key.\n\n    Returns:\n        Shape builder instance from ``self.shapers``.\n    \"\"\"\n    family = ShapeFamily[data[\"family\"].upper().replace(\" \", \"_\")]\n    return self.shapers[family]\n</code></pre>"},{"location":"api/utils/#OpenMagneticsVirtualBuilder.utils.BuilderBase.get_families","title":"get_families","text":"<pre><code>get_families()\n</code></pre> <p>Return dimensions and subtypes for every registered shape family.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/utils.py</code> <pre><code>def get_families(self):\n    \"\"\"Return dimensions and subtypes for every registered shape family.\"\"\"\n    return {shaper.name.lower().replace(\"_\", \" \"): self.factory({\"family\": shaper.name}).get_dimensions_and_subtypes() for shaper in self.shapers}\n</code></pre>"},{"location":"api/utils/#functions","title":"Functions","text":""},{"location":"api/utils/#OpenMagneticsVirtualBuilder.utils.flatten_dimensions","title":"OpenMagneticsVirtualBuilder.utils.flatten_dimensions","text":"<pre><code>flatten_dimensions(data, scale_factor=1.0)\n</code></pre> <p>Convert MAS min/max/nominal dimension values to a flat dict of floats.</p> <p>MAS dimensions can be specified as <code>{\"nominal\": v}</code>, <code>{\"minimum\": v, \"maximum\": v}</code>, or plain numbers.  This function resolves each to a single nominal value and applies scale_factor.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <p>Dict with a <code>\"dimensions\"</code> key containing the MAS dimension map.</p> required <code>scale_factor</code> <p>Multiplicative factor applied to every value (e.g. <code>1000</code> to convert m to mm).</p> <code>1.0</code> <p>Returns:</p> Type Description <p>Dict mapping dimension letter (<code>\"A\"</code>, <code>\"B\"</code>, ...) to a float</p> <p>value.  The <code>\"alpha\"</code> key, if present, is excluded.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/utils.py</code> <pre><code>def flatten_dimensions(data, scale_factor=1.0):\n    \"\"\"Convert MAS min/max/nominal dimension values to a flat dict of floats.\n\n    MAS dimensions can be specified as ``{\"nominal\": v}``,\n    ``{\"minimum\": v, \"maximum\": v}``, or plain numbers.  This function\n    resolves each to a single nominal value and applies *scale_factor*.\n\n    Args:\n        data: Dict with a ``\"dimensions\"`` key containing the MAS dimension\n            map.\n        scale_factor: Multiplicative factor applied to every value\n            (e.g. ``1000`` to convert m to mm).\n\n    Returns:\n        Dict mapping dimension letter (``\"A\"``, ``\"B\"``, ...) to a float\n        value.  The ``\"alpha\"`` key, if present, is excluded.\n    \"\"\"\n    dimensions = copy.deepcopy(data[\"dimensions\"])\n    for k, v in dimensions.items():\n        if isinstance(v, dict):\n            if \"nominal\" not in v or v[\"nominal\"] is None:\n                if \"maximum\" not in v or v[\"maximum\"] is None:\n                    v[\"nominal\"] = v[\"minimum\"]\n                elif \"minimum\" not in v or v[\"minimum\"] is None:\n                    v[\"nominal\"] = v[\"maximum\"]\n                else:\n                    v[\"nominal\"] = round((v[\"maximum\"] + v[\"minimum\"]) / 2, 6)\n        else:\n            dimensions[k] = {\"nominal\": v}\n    return {k: v[\"nominal\"] * scale_factor for k, v in dimensions.items() if k != \"alpha\"}\n</code></pre>"},{"location":"api/utils/#OpenMagneticsVirtualBuilder.utils.decimal_ceil","title":"OpenMagneticsVirtualBuilder.utils.decimal_ceil","text":"<pre><code>decimal_ceil(a, precision=0)\n</code></pre> <p>Ceiling rounded to precision decimal places.</p> <p>Parameters:</p> Name Type Description Default <code>a</code> <p>Numeric value.</p> required <code>precision</code> <p>Number of decimal places.</p> <code>0</code> <p>Returns:</p> Type Description <p>Rounded-up value as a float.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/utils.py</code> <pre><code>def decimal_ceil(a, precision=0):\n    \"\"\"Ceiling rounded to *precision* decimal places.\n\n    Args:\n        a: Numeric value.\n        precision: Number of decimal places.\n\n    Returns:\n        Rounded-up value as a float.\n    \"\"\"\n    return numpy.true_divide(numpy.ceil(a * 10**precision), 10**precision)\n</code></pre>"},{"location":"api/utils/#OpenMagneticsVirtualBuilder.utils.decimal_floor","title":"OpenMagneticsVirtualBuilder.utils.decimal_floor","text":"<pre><code>decimal_floor(a, precision=0)\n</code></pre> <p>Floor rounded to precision decimal places.</p> <p>Parameters:</p> Name Type Description Default <code>a</code> <p>Numeric value.</p> required <code>precision</code> <p>Number of decimal places.</p> <code>0</code> <p>Returns:</p> Type Description <p>Rounded-down value as a float.</p> Source code in <code>src/OpenMagneticsVirtualBuilder/utils.py</code> <pre><code>def decimal_floor(a, precision=0):\n    \"\"\"Floor rounded to *precision* decimal places.\n\n    Args:\n        a: Numeric value.\n        precision: Number of decimal places.\n\n    Returns:\n        Rounded-down value as a float.\n    \"\"\"\n    return numpy.true_divide(numpy.floor(a * 10**precision), 10**precision)\n</code></pre>"},{"location":"architecture/data-flow/","title":"Data Flow","text":""},{"location":"architecture/data-flow/#core-generation-pipeline","title":"Core Generation Pipeline","text":"<pre><code>flowchart TD\n    A[MAS JSON Input] --&gt; B[flatten_dimensions]\n    B --&gt; C{Shape Family}\n    C --&gt; D[get_shape_base - 2D Sketch]\n    D --&gt; E[extrude_sketch - 3D Solid]\n    E --&gt; F[get_negative_winding_window]\n    F --&gt; G[Boolean Subtract]\n    G --&gt; H[get_shape_extras - Position]\n    H --&gt; I{Has Machining?}\n    I --&gt;|Yes| J[apply_machining - Cut Gaps]\n    I --&gt;|No| K[Scale to Meters]\n    J --&gt; K\n    K --&gt; L[Export STEP / STL]</code></pre>"},{"location":"architecture/data-flow/#dimension-flattening","title":"Dimension Flattening","text":"<p>MAS dimensions can be specified in three ways:</p> <pre><code>// Plain number\n\"A\": 0.042\n\n// Nominal value\n\"A\": {\"nominal\": 0.042}\n\n// Min/max range (nominal is computed as average)\n\"A\": {\"minimum\": 0.041, \"maximum\": 0.043}\n</code></pre> <p>The <code>flatten_dimensions()</code> function resolves all formats to a single numeric value:</p> <pre><code>from OpenMagneticsVirtualBuilder.utils import flatten_dimensions\n\ndata = {\n    \"dimensions\": {\n        \"A\": {\"minimum\": 0.041, \"maximum\": 0.043},\n        \"B\": {\"nominal\": 0.021},\n        \"C\": 0.017\n    }\n}\n\nflat = flatten_dimensions(data, scale_factor=1000)\n# {\"A\": 42.0, \"B\": 21.0, \"C\": 17.0}  (converted to mm)\n</code></pre>"},{"location":"architecture/data-flow/#gapping-machining","title":"Gapping / Machining","text":"<p>Core gaps are specified as machining operations in the geometrical description:</p> <pre><code>{\n    \"machining\": [\n        {\n            \"type\": \"subtractive\",\n            \"length\": 0.0005,\n            \"coordinates\": [0, 0, 0]\n        }\n    ]\n}\n</code></pre> <p>The <code>apply_machining()</code> method creates a tool solid and performs a boolean subtraction from the core piece.</p> <ul> <li>coordinates[0] == 0: Center-leg gap (uses column width <code>F</code>)</li> <li>coordinates[0] != 0: Lateral-leg gap (uses half of <code>A</code>)</li> </ul>"},{"location":"architecture/data-flow/#technical-drawing-pipeline","title":"Technical Drawing Pipeline","text":"<pre><code>flowchart TD\n    A[3D Core Shape] --&gt; B{Format}\n    B --&gt;|SVG| C[HLR Projection]\n    B --&gt;|DXF| D[Cross-Section Slice]\n    B --&gt;|FCMacro| E[Cross-Section Slice]\n    C --&gt; F[Add Dimension Annotations]\n    D --&gt; G[DXF Edge Export]\n    E --&gt; H[FCMacro Script Generation]\n    F --&gt; I[SVG Output]\n    G --&gt; J[DXF Output]\n    H --&gt; K[FCMacro Output]</code></pre>"},{"location":"architecture/data-flow/#svg-generation","title":"SVG Generation","text":"<ol> <li>Shape is projected using OCC hidden-line removal (HLR)</li> <li>Visible and hidden edges are separated</li> <li>Dimension annotations are computed from shape bounding box</li> <li>SVG markup is assembled with projection lines and labels</li> </ol>"},{"location":"architecture/data-flow/#dxf-generation","title":"DXF Generation","text":"<ol> <li>Shape is sliced at the principal plane (XY, XZ, or ZY)</li> <li>Cross-section edges are extracted</li> <li>Edges are written to DXF format via <code>ezdxf</code></li> </ol>"},{"location":"architecture/data-flow/#complete-magnetic-pipeline","title":"Complete Magnetic Pipeline","text":"<pre><code>flowchart TD\n    A[MAS Magnetic Data] --&gt; B[Core Generation]\n    A --&gt; C[Bobbin Generation]\n    A --&gt; D[Coil Generation]\n    B --&gt; E[Assembly]\n    C --&gt; E\n    D --&gt; E\n    E --&gt; F[Export STEP / STL]\n\n    D --&gt; D1[Parse Turns Description]\n    D1 --&gt; D2[Build Individual Turns]\n    D2 --&gt; D3{Wire Type}\n    D3 --&gt;|Round| D4[Torus Sweep]\n    D3 --&gt;|Rectangular| D5[Rectangular Sweep]\n    D3 --&gt;|Foil| D6[Foil Sweep]\n    D4 --&gt; D7[Combine Turns]\n    D5 --&gt; D7\n    D6 --&gt; D7</code></pre>"},{"location":"architecture/data-flow/#turn-hierarchy","title":"Turn Hierarchy","text":"<ol> <li>Turn: Single wire loop around the core column</li> <li>Layer: Multiple turns stacked vertically</li> <li>Section: Multiple layers stacked radially</li> <li>Winding: Complete winding (primary, secondary, etc.)</li> <li>Coil: All windings combined</li> <li>Magnetic: Core + bobbin + coil assembly</li> </ol>"},{"location":"architecture/engines/","title":"CAD Engines","text":"<p>MVB implements the Strategy pattern with two interchangeable rendering engines.</p>"},{"location":"architecture/engines/#engine-comparison","title":"Engine Comparison","text":"Feature CadQuery FreeCAD System install required No Yes CI / headless support Yes Limited 3D export (STEP, STL) Yes Yes OBJ export No Yes SVG drawings Yes Yes DXF drawings Yes No FCMacro sketches Yes Yes Technical drawings with dimensions Yes Yes Performance Fast Moderate"},{"location":"architecture/engines/#when-to-use-which","title":"When to Use Which","text":""},{"location":"architecture/engines/#cadquery-default","title":"CadQuery (Default)","text":"<p>Choose CadQuery when:</p> <ul> <li>Running in CI/CD pipelines or Docker containers</li> <li>No FreeCAD installation available</li> <li>Cross-platform compatibility required</li> <li>You need DXF output</li> </ul> <pre><code>builder = Builder(\"CadQuery\")\n</code></pre>"},{"location":"architecture/engines/#freecad","title":"FreeCAD","text":"<p>Choose FreeCAD when:</p> <ul> <li>FreeCAD is already installed</li> <li>You need OBJ mesh export</li> <li>You need FreeCAD-native project files (<code>.FCStd</code>)</li> </ul> <pre><code>builder = Builder(\"FreeCAD\")\n</code></pre>"},{"location":"architecture/engines/#engine-architecture","title":"Engine Architecture","text":"<pre><code>classDiagram\n    class BuilderBase {\n        +factory(data) IPiece\n        +get_families() dict\n    }\n    class CadQueryBuilder {\n        +shapers: dict\n        +get_core()\n        +get_magnetic()\n        +get_bobbin()\n        +get_winding()\n        +get_svg_drawings()\n        +get_dxf_drawings()\n    }\n    class FreeCADBuilder {\n        +shapers: dict\n        +get_core()\n        +get_magnetic()\n        +get_bobbin()\n        +get_winding()\n    }\n    class Builder {\n        +engine: BuilderBase\n        +factory()\n        +get_core()\n        +get_magnetic()\n    }\n    BuilderBase &lt;|-- CadQueryBuilder\n    BuilderBase &lt;|-- FreeCADBuilder\n    Builder --&gt; BuilderBase : delegates to</code></pre>"},{"location":"architecture/engines/#freecad-path-discovery","title":"FreeCAD Path Discovery","text":"<p>The FreeCAD engine searches standard installation paths:</p> LinuxWindows <ol> <li><code>/usr/lib/freecad/lib</code></li> <li><code>/usr/lib/freecad-daily/lib</code></li> </ol> <ol> <li><code>%LOCALAPPDATA%\\Programs\\FreeCAD 1.0\\bin</code></li> <li><code>%LOCALAPPDATA%\\Programs\\FreeCAD 0.21\\bin</code></li> <li><code>%ProgramFiles%\\FreeCAD 1.0\\bin</code></li> </ol>"},{"location":"architecture/engines/#tessellation-quality","title":"Tessellation Quality","text":"<p>The CadQuery engine supports configurable tessellation quality for STL export:</p> <pre><code>from OpenMagneticsVirtualBuilder.cadquery_builder import set_tessellation_quality\n\n# Coarse quality for fast previews\nset_tessellation_quality(segments_per_circle=12)\n\n# High quality for final renders\nset_tessellation_quality(segments_per_circle=48, linear_tolerance=0.01)\n</code></pre> Preset Segments Use Case Coarse 8-12 Quick previews Medium (default) 16-24 Balanced quality High 32-48 Smooth curves Ultra 64+ Final renders"},{"location":"architecture/overview/","title":"Architecture Overview","text":""},{"location":"architecture/overview/#high-level-block-diagram","title":"High-Level Block Diagram","text":"<pre><code>graph LR\n    MAS[MAS JSON Data] --&gt; Builder\n    Builder --&gt; CQ[CadQueryBuilder]\n    Builder --&gt; FC[FreeCADBuilder]\n    CQ --&gt; Shapes[Shape Classes]\n    FC --&gt; Shapes\n    Shapes --&gt; STEP[.step]\n    Shapes --&gt; STL[.stl]\n    Shapes --&gt; OBJ[.obj]\n    CQ --&gt; Draw[Drawing 2D]\n    FC --&gt; Draw\n    Draw --&gt; SVG[.svg]\n    Draw --&gt; DXF[.dxf]\n    Draw --&gt; FCM[.FCMacro]</code></pre>"},{"location":"architecture/overview/#component-table","title":"Component Table","text":"Component File Responsibility Builder <code>builder.py</code> Main API facade, engine selection CadQueryBuilder <code>cadquery_builder.py</code> CadQuery rendering engine (~3800 lines) FreeCADBuilder <code>freecad_builder.py</code> FreeCAD rendering engine (~3800 lines) Drawing 2D <code>drawing_2d.py</code> Multi-format 2D technical drawings Utils <code>utils.py</code> ShapeFamily enum, dimension helpers Shape Configs <code>shape_configs.py</code> Shared dimension/subtype tables Magnetic Builder <code>magnetic_builder.py</code> Backward-compatibility wrapper"},{"location":"architecture/overview/#design-patterns","title":"Design Patterns","text":""},{"location":"architecture/overview/#strategy-pattern-engine-selection","title":"Strategy Pattern (Engine Selection)","text":"<p>The <code>Builder</code> class acts as a facade. At construction time it instantiates either <code>CadQueryBuilder</code> or <code>FreeCADBuilder</code>, then delegates every method call to the chosen engine:</p> <pre><code>builder = Builder(\"CadQuery\")   # picks CadQueryBuilder\nbuilder = Builder(\"FreeCAD\")    # picks FreeCADBuilder\n</code></pre> <p>Both engines inherit from <code>BuilderBase</code> and expose identical public APIs.</p>"},{"location":"architecture/overview/#template-method-shape-generation","title":"Template Method (Shape Generation)","text":"<p>Each engine contains ~20 nested shape classes that inherit from <code>IPiece</code>. The base class defines the generation pipeline:</p> <ol> <li><code>get_shape_base()</code> - create the 2D sketch (abstract)</li> <li><code>extrude_sketch()</code> - extrude to 3D</li> <li><code>get_negative_winding_window()</code> - subtract winding window (abstract)</li> <li><code>get_shape_extras()</code> - translate/transform</li> <li><code>apply_machining()</code> - apply gaps</li> </ol> <p>Concrete shape classes (E, PQ, T, etc.) override the abstract methods.</p>"},{"location":"architecture/overview/#coordinate-system","title":"Coordinate System","text":""},{"location":"architecture/overview/#concentric-cores-e-pq-rm-etc","title":"Concentric Cores (E, PQ, RM, etc.)","text":"Axis Direction MAS Mapping X Core depth (perpendicular to winding window) - Y Core width (radial distance from central column) <code>coordinates[0]</code> Z Core height (along core axis, vertical) <code>coordinates[1]</code>"},{"location":"architecture/overview/#toroidal-cores","title":"Toroidal Cores","text":"Axis Direction MAS Mapping X Radial direction <code>coordinates[0]</code> (distance) Y Core axis (toroid revolves around Y) - Z Tangential direction -"},{"location":"architecture/overview/#units","title":"Units","text":"<ul> <li>Input: All MAS values are in meters</li> <li>Internal: Geometry is built in millimeters for numerical precision</li> <li>Output: Scaled back to meters before STEP/STL export (factor 1000)</li> </ul>"},{"location":"architecture/shape-hierarchy/","title":"Shape Class Hierarchy","text":""},{"location":"architecture/shape-hierarchy/#class-inheritance","title":"Class Inheritance","text":"<p>Each engine contains nested shape classes that implement specific core geometries. The class hierarchy follows the EN 60205 standard grouping:</p> <pre><code>classDiagram\n    class IPiece {\n        &lt;&lt;abstract&gt;&gt;\n        +get_shape_base(data)*\n        +get_negative_winding_window(dimensions)*\n        +get_piece(data)\n        +get_plate(data)\n        +get_piece_technical_drawing(data)\n        +apply_machining(piece, machining, dimensions)\n        +get_dimensions_and_subtypes()\n    }\n\n    class E {\n        +get_shape_base(data)\n        +get_negative_winding_window(dimensions)\n    }\n\n    class P {\n        +get_shape_base(data)\n        +get_negative_winding_window(dimensions)\n    }\n\n    class U {\n        +get_shape_base(data)\n        +get_negative_winding_window(dimensions)\n    }\n\n    class T {\n        +get_shape_base(data)\n        +get_negative_winding_window(dimensions)\n    }\n\n    IPiece &lt;|-- E\n    IPiece &lt;|-- P\n    IPiece &lt;|-- U\n    IPiece &lt;|-- T\n\n    E &lt;|-- Er\n    E &lt;|-- Ep\n    E &lt;|-- Epx\n    E &lt;|-- Efd\n    E &lt;|-- El\n\n    Er &lt;|-- Etd\n    Er &lt;|-- Lp\n    Er &lt;|-- Eq\n    Er &lt;|-- Ec\n\n    P &lt;|-- Pq\n    P &lt;|-- Rm\n    P &lt;|-- Pm\n\n    IPiece &lt;|-- Ur\n    IPiece &lt;|-- Ut\n    U &lt;|-- C</code></pre>"},{"location":"architecture/shape-hierarchy/#shape-families-and-en-60205-naming","title":"Shape Families and EN 60205 Naming","text":"Class Family EN 60205 Name Base Class <code>E</code> E E cores <code>IPiece</code> <code>Etd</code> ETD E cores, round center leg <code>Er</code> <code>Er</code> ER E cores, round center leg <code>E</code> <code>Ep</code> EP E cores, pot-like <code>E</code> <code>Epx</code> EPX E cores, pot-like extended <code>E</code> <code>Efd</code> EFD E cores, flat design <code>E</code> <code>Ec</code> EC E cores, cylindrical <code>Er</code> <code>Eq</code> EQ E cores, square <code>Er</code> <code>El</code> EL E cores, low profile <code>E</code> <code>Lp</code> LP Low-profile planar <code>Er</code> <code>P</code> P Pot cores <code>IPiece</code> <code>Pq</code> PQ Pot cores, quasi-planar <code>P</code> <code>Pm</code> PM Pot cores, modified <code>P</code> <code>Rm</code> RM Pot cores, rectangular <code>P</code> <code>U</code> U U cores <code>IPiece</code> <code>Ur</code> UR U cores, round <code>IPiece</code> <code>Ut</code> UT U cores, T-shape <code>IPiece</code> <code>C</code> C Cut C-cores <code>U</code> <code>T</code> T Toroidal cores <code>IPiece</code>"},{"location":"architecture/shape-hierarchy/#dimension-naming-convention","title":"Dimension Naming Convention","text":"<p>All shapes use single-letter dimension names from EN 60205:</p> Dimension Meaning A Overall width (largest horizontal dimension) B Overall height of one half C Winding window height D Center leg height (below winding window) E Center leg width or outer leg spacing F Center leg depth / diameter G Additional dimension (shape-specific) H Additional dimension (shape-specific) J Additional dimension (RM family)"},{"location":"architecture/shape-hierarchy/#subtypes","title":"Subtypes","text":"<p>Some shape families have multiple subtypes (1-4), each with different dimension sets:</p> <pre><code># P family has 4 subtypes\nP_DIMENSIONS_AND_SUBTYPES = {\n    1: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"],\n    2: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"],\n    3: [\"A\", \"B\", \"D\", \"E\", \"F\", \"G\", \"H\"],\n    4: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"],\n}\n\n# RM family has 4 subtypes\nRM_DIMENSIONS_AND_SUBTYPES = {\n    1: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"J\"],\n    ...\n}\n</code></pre>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#from-pypi","title":"From PyPI","text":"<pre><code>pip install OpenMagneticsVirtualBuilder\n</code></pre>"},{"location":"getting-started/installation/#from-source","title":"From Source","text":"<pre><code>git clone https://github.com/OpenMagnetics/MVB.git\ncd MVB\npip install -e .\n</code></pre>"},{"location":"getting-started/installation/#dependencies","title":"Dependencies","text":"<p>The CadQuery engine (default) requires:</p> <pre><code>pip install cadquery numpy\n</code></pre> <p>For 2D drawing export (DXF format):</p> <pre><code>pip install ezdxf\n</code></pre>"},{"location":"getting-started/installation/#freecad-engine-setup","title":"FreeCAD Engine Setup","text":"<p>The FreeCAD engine requires a system FreeCAD installation.</p> LinuxWindows <pre><code>sudo apt install freecad\n</code></pre> <p>The builder searches for FreeCAD in:</p> <ul> <li><code>/usr/lib/freecad</code></li> <li><code>/usr/lib/freecad-daily</code></li> </ul> <p>Install FreeCAD from freecad.org.</p> <p>The builder searches in:</p> <ul> <li><code>%LOCALAPPDATA%\\Programs\\FreeCAD 1.0</code></li> <li><code>%LOCALAPPDATA%\\Programs\\FreeCAD 0.21</code></li> <li><code>%ProgramFiles%\\FreeCAD 1.0</code></li> </ul>"},{"location":"getting-started/installation/#mas-data","title":"MAS Data","text":"<p>Tests and some examples require the MAS repository with core shape definitions:</p> <pre><code>git clone https://github.com/OpenMagnetics/MAS.git ../MAS\n</code></pre> <p>The <code>core_shapes.ndjson</code> file should be at <code>../MAS/data/core_shapes.ndjson</code> relative to the MVB project root.</p>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\n\nbuilder = Builder(\"CadQuery\")\nfamilies = builder.get_families()\nprint(f\"Available families: {len(families)}\")\n# Available families: 21\n</code></pre>"},{"location":"getting-started/quickstart/","title":"Quick Start","text":"<p>Generate your first magnetic core in 5 minutes.</p>"},{"location":"getting-started/quickstart/#1-create-a-builder","title":"1. Create a Builder","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\n\nbuilder = Builder(\"CadQuery\")  # default engine, no system deps\n</code></pre>"},{"location":"getting-started/quickstart/#2-list-available-families","title":"2. List Available Families","text":"<pre><code>families = builder.get_families()\nfor name, info in families.items():\n    print(f\"{name}: {info}\")\n</code></pre> <p>Output:</p> <pre><code>etd: {1: ['A', 'B', 'C', 'D', 'E', 'F']}\ner: {1: ['A', 'B', 'C', 'D', 'E', 'F']}\nep: {1: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H']}\n...\n</code></pre>"},{"location":"getting-started/quickstart/#3-generate-a-core","title":"3. Generate a Core","text":"<p>Core generation uses MAS geometrical descriptions. Each piece of the core is described by its shape family, dimensions, and optional machining (gapping):</p> <pre><code>import json\n\n# E 42/21/20 core - two halves with a center-leg gap\ngeometrical_description = [\n    {\n        \"type\": \"half set\",\n        \"shape\": {\n            \"family\": \"etd\",\n            \"name\": \"ETD 42/21/20\",\n            \"dimensions\": {\n                \"A\": {\"nominal\": 0.0422},\n                \"B\": {\"nominal\": 0.0214},\n                \"C\": {\"nominal\": 0.01720},\n                \"D\": {\"nominal\": 0.01490},\n                \"E\": {\"nominal\": 0.03020},\n                \"F\": {\"nominal\": 0.01370}\n            }\n        },\n        \"machining\": []\n    },\n    {\n        \"type\": \"half set\",\n        \"shape\": {\n            \"family\": \"etd\",\n            \"name\": \"ETD 42/21/20\",\n            \"dimensions\": {\n                \"A\": {\"nominal\": 0.0422},\n                \"B\": {\"nominal\": 0.0214},\n                \"C\": {\"nominal\": 0.01720},\n                \"D\": {\"nominal\": 0.01490},\n                \"E\": {\"nominal\": 0.03020},\n                \"F\": {\"nominal\": 0.01370}\n            }\n        },\n        \"rotation\": [3.14159, 0, 0],\n        \"machining\": []\n    }\n]\n\nstep_path, stl_path = builder.get_core(\n    \"my_etd42\",\n    geometrical_description,\n    output_path=\"./output/\"\n)\nprint(f\"STEP: {step_path}\")\nprint(f\"STL:  {stl_path}\")\n</code></pre>"},{"location":"getting-started/quickstart/#4-generate-a-technical-drawing","title":"4. Generate a Technical Drawing","text":"<pre><code>core_data = {\n    \"geometricalDescription\": geometrical_description,\n    \"processedDescription\": {\n        \"gapping\": [\n            {\n                \"type\": \"subtractive\",\n                \"length\": 0.0005,\n                \"coordinates\": [0, 0, 0]\n            }\n        ]\n    }\n}\n\nsvg = builder.get_core_gapping_technical_drawing(\n    \"my_etd42_drawing\",\n    core_data,\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"getting-started/quickstart/#5-generate-a-complete-magnetic","title":"5. Generate a Complete Magnetic","text":"<p>For a full magnetic component (core + bobbin + coil), load MAS JSON data:</p> <pre><code>import json\n\nwith open(\"tests/testData/ETD49_N87_10uH_5T.json\") as f:\n    magnetic_data = json.load(f)\n\nstep_path, stl_path = builder.get_magnetic(\n    magnetic_data,\n    \"ETD49_magnetic\",\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"getting-started/quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Core Generation Tutorial - detailed walkthrough</li> <li>Complete Magnetic Tutorial - full assembly example</li> <li>Shape Catalog - browse all 21 shape families</li> <li>API Reference - full method documentation</li> </ul>"},{"location":"shapes/","title":"Shape Catalog","text":"<p>MVB supports 21 magnetic core shape families following the EN 60205 standard naming convention.</p>"},{"location":"shapes/#families-at-a-glance","title":"Families at a Glance","text":"Family Shapes Typical Application E Family E, ETD, ER, EFD, EC, EQ, EP, EPX General purpose, power supplies P Family P, PQ, PM, RM Shielded, low EMI Planar PLANAR_E, PLANAR_ER, PLANAR_EL, LP Low profile, PCB-mount U Family U, UR, UT High power, chokes Toroidal T EMI filters, current sensors C Cores C High power, adjustable gap"},{"location":"shapes/#dimension-naming-convention","title":"Dimension Naming Convention","text":"<p>All shapes use single-letter dimensions from EN 60205:</p> Letter Typical Meaning A Overall width (largest horizontal dimension) B Overall height of one half C Winding window height D Center leg height (below winding window) E Center leg width or outer leg spacing F Center leg depth / diameter G Shape-specific (EP/EPX pot opening, P inner dims) H Shape-specific (EP/EPX height details, P inner dims) J Shape-specific (RM family only) <p>Note</p> <p>Not all dimensions apply to every shape. For example, toroidal cores only need A (outer diameter), B (inner diameter), and C (height).</p>"},{"location":"shapes/#mas-dimension-format","title":"MAS Dimension Format","text":"<p>Dimensions in MAS data can be specified three ways:</p> <pre><code>// Plain number\n\"A\": 0.042\n\n// Nominal value\n\"A\": {\"nominal\": 0.042}\n\n// Min/max range\n\"A\": {\"minimum\": 0.041, \"maximum\": 0.043}\n</code></pre> <p>The <code>flatten_dimensions()</code> function resolves all formats to a single value.</p>"},{"location":"shapes/#listing-families-programmatically","title":"Listing Families Programmatically","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\n\nbuilder = Builder(\"CadQuery\")\nfamilies = builder.get_families()\n\nfor name, subtypes in families.items():\n    print(f\"{name}:\")\n    for subtype, dims in subtypes.items():\n        print(f\"  Subtype {subtype}: {dims}\")\n</code></pre>"},{"location":"shapes/c-family/","title":"C Cores","text":"<p>C-shaped cut cores for high-power applications with adjustable air gaps.</p>"},{"location":"shapes/c-family/#c-cut-c-core","title":"C - Cut C-Core","text":"<p>C-cores are manufactured by cutting a toroidal or wound core in half. Two C-cores are assembled face-to-face with an optional air gap.</p> Dimension Description A Overall width B Overall height C Leg width D Window width E Leg depth <p>Class hierarchy: <code>C(U)</code> - inherits from U-core</p>"},{"location":"shapes/c-family/#c-core-vs-u-core","title":"C-Core vs U-Core","text":"<p>The C-core class inherits directly from U since the geometry is identical. The distinction is in assembly: C-cores always come in pairs (two halves facing each other), while U-cores may be paired with an I-bar.</p>"},{"location":"shapes/c-family/#example","title":"Example","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\nimport copy\n\nbuilder = Builder(\"CadQuery\")\n\nc_shape = {\n    \"family\": \"c\",\n    \"name\": \"C 20\",\n    \"familySubtype\": \"1\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.020},\n        \"B\": {\"nominal\": 0.020},\n        \"C\": {\"nominal\": 0.005},\n        \"D\": {\"nominal\": 0.010},\n        \"E\": {\"nominal\": 0.010},\n    }\n}\n\n# Two C-halves mirrored to form a complete core\ngeo_desc = [\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(c_shape),\n     \"rotation\": [0, 0, 0], \"coordinates\": [0, 0], \"machining\": None},\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(c_shape),\n     \"rotation\": [0, 3.14159265359, 0], \"coordinates\": [0, 0], \"machining\": None},\n]\n\nstep_path, stl_path = builder.get_core(\"C_20\", geo_desc, output_path=\"./output/\")\n</code></pre>"},{"location":"shapes/c-family/#gapping","title":"Gapping","text":"<p>C-cores naturally have a gap at the joint faces. Additional machining can be applied to increase the gap:</p> <pre><code>geo_desc_gapped = [\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(c_shape),\n     \"rotation\": [0, 0, 0], \"coordinates\": [0, 0],\n     \"machining\": [{\"type\": \"subtractive\", \"length\": 0.001, \"coordinates\": [0, 0, 0]}]},\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(c_shape),\n     \"rotation\": [0, 3.14159265359, 0], \"coordinates\": [0, 0],\n     \"machining\": None},\n]\n</code></pre>"},{"location":"shapes/c-family/#full-c-core-magnetic","title":"Full C-Core Magnetic","text":"<p>For a complete example with windings, see the C-Core Tutorial.</p>"},{"location":"shapes/e-family/","title":"E Family","text":"<p>The E family is the most common core shape family, with many variants for different applications.</p>"},{"location":"shapes/e-family/#shapes","title":"Shapes","text":""},{"location":"shapes/e-family/#e-standard-e-core","title":"E - Standard E Core","text":"<p>The basic E-shaped core with rectangular cross-section legs.</p> Dimension Description A Overall width B Overall height (one half) C Winding window height D Center leg height below window E Outer leg spacing F Center leg width <pre><code>e_shape = {\n    \"family\": \"e\",\n    \"name\": \"E 42/21/20\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.042},\n        \"B\": {\"nominal\": 0.021},\n        \"C\": {\"nominal\": 0.0157},\n        \"D\": {\"nominal\": 0.0145},\n        \"E\": {\"nominal\": 0.0296},\n        \"F\": {\"nominal\": 0.0142},\n    }\n}\n</code></pre> <p>Class hierarchy: <code>E(IPiece)</code></p>"},{"location":"shapes/e-family/#etd-e-core-with-round-center-leg","title":"ETD - E Core with Round Center Leg","text":"<p>E core variant where the center leg has a round cross-section, reducing winding length.</p> <p>Dimensions: Same as E (A, B, C, D, E, F)</p> <p>Class hierarchy: <code>Etd(Er(E))</code></p>"},{"location":"shapes/e-family/#er-e-core-with-round-center","title":"ER - E Core with Round Center","text":"<p>E core with a round center column. Base class for ETD, LP, EQ, EC.</p> <p>Dimensions: A, B, C, D, E, F</p> <p>Class hierarchy: <code>Er(E)</code></p>"},{"location":"shapes/e-family/#efd-e-core-flat-design","title":"EFD - E Core, Flat Design","text":"<p>Low-profile E core designed for flat transformers. Uses a modified winding window geometry.</p> <p>Dimensions: A, B, C, D, E, F</p> <p>Class hierarchy: <code>Efd(E)</code></p>"},{"location":"shapes/e-family/#ec-e-core-cylindrical","title":"EC - E Core, Cylindrical","text":"<p>E core with a cylindrical center leg and modified outer legs.</p> <p>Dimensions: A, B, C, D, E, F</p> <p>Class hierarchy: <code>Ec(Er)</code></p>"},{"location":"shapes/e-family/#eq-e-core-square","title":"EQ - E Core, Square","text":"<p>E core optimized for minimal air gap effects.</p> <p>Dimensions: A, B, C, D, E, F</p> <p>Class hierarchy: <code>Eq(Er)</code></p>"},{"location":"shapes/e-family/#ep-e-core-pot-like","title":"EP - E Core, Pot-Like","text":"<p>E core with a partially enclosed winding area, offering some shielding.</p> Dimension Description A Overall width B Overall height C Winding window height D Base height E Outer dimension F Center leg dimension G Opening width H Additional height dimension <p>Class hierarchy: <code>Ep(E)</code></p>"},{"location":"shapes/e-family/#epx-e-core-pot-like-extended","title":"EPX - E Core, Pot-Like Extended","text":"<p>Extended variant of EP with additional dimensional parameters.</p> Dimension Description A-H Same as EP <p>Class hierarchy: <code>Epx(E)</code></p>"},{"location":"shapes/e-family/#generating-an-e-family-core","title":"Generating an E-Family Core","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\nimport copy\n\nbuilder = Builder(\"CadQuery\")\n\nshape_data = {\n    \"family\": \"etd\",\n    \"name\": \"ETD 49/25/16\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.0492},\n        \"B\": {\"nominal\": 0.0250},\n        \"C\": {\"nominal\": 0.01720},\n        \"D\": {\"nominal\": 0.01745},\n        \"E\": {\"nominal\": 0.03780},\n        \"F\": {\"nominal\": 0.01650},\n    }\n}\n\ngeo_desc = [\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(shape_data),\n     \"rotation\": [0, 0, 0], \"coordinates\": [0, 0], \"machining\": None},\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(shape_data),\n     \"rotation\": [3.14159265359, 0, 0], \"coordinates\": [0, 0], \"machining\": None},\n]\n\nstep_path, stl_path = builder.get_core(\"ETD49\", geo_desc, output_path=\"./output/\")\n</code></pre>"},{"location":"shapes/p-family/","title":"P Family","text":"<p>Pot cores and their variants. These shapes provide partial or full shielding of the winding, reducing electromagnetic interference.</p>"},{"location":"shapes/p-family/#shapes","title":"Shapes","text":""},{"location":"shapes/p-family/#p-pot-core","title":"P - Pot Core","text":"<p>Fully enclosed pot core with a cylindrical winding area.</p> Dimension Description A Overall diameter B Overall height (one half) C Winding window height D Base height E Center post diameter F Winding area outer diameter G Inner dimension H Additional dimension <p>P cores have 4 subtypes, each using a slightly different dimension set.</p> <p>Class hierarchy: <code>P(IPiece)</code></p>"},{"location":"shapes/p-family/#pq-pot-core-quasi-planar","title":"PQ - Pot Core, Quasi-Planar","text":"<p>Modified pot core with a more rectangular profile, optimized for PCB mounting while maintaining some shielding.</p> <p>Dimensions: A, B, C, D, E, F, G, H</p> <p>Class hierarchy: <code>Pq(P)</code></p>"},{"location":"shapes/p-family/#pm-pot-core-modified","title":"PM - Pot Core, Modified","text":"<p>Modified pot core geometry with non-circular outer profile.</p> <p>Dimensions: A, B, C, D, E, F, G, H</p> <p>Class hierarchy: <code>Pm(P)</code></p>"},{"location":"shapes/p-family/#rm-pot-core-rectangular","title":"RM - Pot Core, Rectangular","text":"<p>Rectangular pot core combining the shielding benefits of pot cores with the mounting convenience of rectangular shapes.</p> Dimension Description A-H Standard pot core dimensions J Additional dimension <p>RM cores have 4 subtypes.</p> <p>Class hierarchy: <code>Rm(P)</code></p>"},{"location":"shapes/p-family/#subtypes","title":"Subtypes","text":"<p>P and RM families support multiple subtypes:</p> <pre><code># P family subtypes\nP_DIMENSIONS_AND_SUBTYPES = {\n    1: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"],\n    2: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"],\n    3: [\"A\", \"B\", \"D\", \"E\", \"F\", \"G\", \"H\"],      # No \"C\"\n    4: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"],\n}\n\n# RM family subtypes\nRM_DIMENSIONS_AND_SUBTYPES = {\n    1: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"J\"],\n    2: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"J\"],\n    3: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"J\"],\n    4: [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"J\"],\n}\n</code></pre>"},{"location":"shapes/p-family/#generating-a-pq-core","title":"Generating a PQ Core","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\nimport copy\n\nbuilder = Builder(\"CadQuery\")\n\npq_shape = {\n    \"family\": \"pq\",\n    \"name\": \"PQ 40/40\",\n    \"familySubtype\": \"1\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.0404},\n        \"B\": {\"nominal\": 0.0386},\n        \"C\": {\"nominal\": 0.0287},\n        \"D\": {\"nominal\": 0.0275},\n        \"E\": {\"nominal\": 0.0285},\n        \"F\": {\"nominal\": 0.0135},\n    }\n}\n\ngeo_desc = [\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(pq_shape),\n     \"rotation\": [0, 0, 0], \"coordinates\": [0, 0], \"machining\": None},\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(pq_shape),\n     \"rotation\": [3.14159265359, 0, 0], \"coordinates\": [0, 0], \"machining\": None},\n]\n\nstep_path, stl_path = builder.get_core(\"PQ4040\", geo_desc, output_path=\"./output/\")\n</code></pre>"},{"location":"shapes/planar-family/","title":"Planar Family","text":"<p>Low-profile cores designed for planar transformers and PCB-integrated magnetics.</p>"},{"location":"shapes/planar-family/#shapes","title":"Shapes","text":""},{"location":"shapes/planar-family/#planar_e-planar-e-core","title":"PLANAR_E - Planar E Core","text":"<p>Low-profile version of the standard E core for planar transformer designs.</p> <p>Dimensions: A, B, C, D, E, F</p> <p>Class hierarchy: In CadQuery engine, uses <code>E</code> base with planar modifications.</p>"},{"location":"shapes/planar-family/#planar_er-planar-er-core","title":"PLANAR_ER - Planar ER Core","text":"<p>Low-profile version of the ER core with a round center leg.</p> <p>Dimensions: A, B, C, D, E, F</p> <p>Class hierarchy: In CadQuery engine, uses <code>Er</code> base with planar modifications.</p>"},{"location":"shapes/planar-family/#planar_el-planar-el-core","title":"PLANAR_EL - Planar EL Core","text":"<p>Extended low-profile E core variant.</p> <p>Dimensions: A, B, C, D, E, F</p> <p>Class hierarchy: In CadQuery engine, uses <code>El</code> base.</p>"},{"location":"shapes/planar-family/#lp-low-profile","title":"LP - Low Profile","text":"<p>Dedicated low-profile core shape, inheriting from the ER class.</p> <p>Dimensions: A, B, C, D, E, F</p> <p>Class hierarchy: <code>Lp(Er(E))</code></p>"},{"location":"shapes/planar-family/#planar-vs-standard-cores","title":"Planar vs Standard Cores","text":"Feature Standard Planar Height Taller Very low profile Winding Wire wound PCB traces Power density Moderate High Typical use Discrete transformers Embedded power"},{"location":"shapes/planar-family/#generating-a-planar-core","title":"Generating a Planar Core","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\nimport copy\n\nbuilder = Builder(\"CadQuery\")\n\nplanar_shape = {\n    \"family\": \"planar_e\",\n    \"name\": \"PLANAR E 32\",\n    \"familySubtype\": \"1\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.032},\n        \"B\": {\"nominal\": 0.006},\n        \"C\": {\"nominal\": 0.0037},\n        \"D\": {\"nominal\": 0.0048},\n        \"E\": {\"nominal\": 0.0229},\n        \"F\": {\"nominal\": 0.0110},\n    }\n}\n\ngeo_desc = [\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(planar_shape),\n     \"rotation\": [0, 0, 0], \"coordinates\": [0, 0], \"machining\": None},\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(planar_shape),\n     \"rotation\": [3.14159265359, 0, 0], \"coordinates\": [0, 0], \"machining\": None},\n]\n\nstep_path, stl_path = builder.get_core(\"PLANAR_E32\", geo_desc, output_path=\"./output/\")\n</code></pre>"},{"location":"shapes/toroidal-family/","title":"Toroidal Cores","text":"<p>Ring-shaped (toroidal) cores used in EMI filters, current sensors, and applications requiring minimal stray flux.</p>"},{"location":"shapes/toroidal-family/#t-toroidal-core","title":"T - Toroidal Core","text":"<p>The simplest core geometry - a ring with only three dimensions.</p> Dimension Description A Outer diameter B Inner diameter C Height (ring thickness) <p>Class hierarchy: <code>T(IPiece)</code></p>"},{"location":"shapes/toroidal-family/#key-properties","title":"Key Properties","text":"<ul> <li>Single piece: No mating surfaces (uses <code>\"type\": \"closed piece\"</code>)</li> <li>No winding window cutout: The center hole is the winding window</li> <li>Minimal stray flux: Fully enclosed magnetic path</li> <li>Revolution geometry: Created by revolving a rectangle around the Y axis</li> </ul>"},{"location":"shapes/toroidal-family/#example","title":"Example","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\nimport copy\n\nbuilder = Builder(\"CadQuery\")\n\nt_shape = {\n    \"family\": \"t\",\n    \"name\": \"T 25/15/10\",\n    \"familySubtype\": \"1\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.0254},\n        \"B\": {\"nominal\": 0.0152},\n        \"C\": {\"nominal\": 0.0102},\n    }\n}\n\ngeo_desc = [\n    {\n        \"type\": \"closed piece\",\n        \"shape\": copy.deepcopy(t_shape),\n        \"rotation\": [0, 0, 0],\n        \"coordinates\": [0, 0],\n        \"machining\": None,\n    }\n]\n\nstep_path, stl_path = builder.get_core(\"T_25_15_10\", geo_desc, output_path=\"./output/\")\n</code></pre>"},{"location":"shapes/toroidal-family/#toroidal-winding","title":"Toroidal Winding","text":"<p>For a complete toroidal magnetic with windings, see the Toroidal Winding Tutorial.</p>"},{"location":"shapes/toroidal-family/#coordinate-system","title":"Coordinate System","text":"<p>Unlike concentric cores, toroidal cores use a cylindrical coordinate mapping:</p> MAS Coordinate CadQuery Axis Meaning <code>coordinates[0]</code> Radial from Y Distance from center <code>coordinates[1]</code> Angle around Y Angular position"},{"location":"shapes/u-family/","title":"U Family","text":"<p>U-shaped cores for high-power applications, chokes, and inductors.</p>"},{"location":"shapes/u-family/#shapes","title":"Shapes","text":""},{"location":"shapes/u-family/#u-standard-u-core","title":"U - Standard U Core","text":"<p>Basic U-shaped core. Two U-cores placed together form a rectangular loop.</p> Dimension Description A Overall width B Overall height C Leg width D Window width E Leg depth <p>U cores have 1 subtype.</p> <p>Class hierarchy: <code>U(IPiece)</code></p>"},{"location":"shapes/u-family/#ur-u-core-round","title":"UR - U Core, Round","text":"<p>U core with rounded leg cross-sections.</p> Dimension Description A Overall width B Overall height C Leg width D Window width H Height dimension F, G Additional dimensions (subtypes 3, 4) <p>UR cores have 4 subtypes with varying dimension sets.</p> <p>Class hierarchy: <code>Ur(IPiece)</code></p>"},{"location":"shapes/u-family/#ut-u-core-t-shape","title":"UT - U Core, T-Shape","text":"<p>U core variant with T-shaped cross-section.</p> <p>Class hierarchy: <code>Ut(IPiece)</code></p>"},{"location":"shapes/u-family/#u-family-subtypes","title":"U Family Subtypes","text":"<pre><code>U_DIMENSIONS_AND_SUBTYPES = {\n    1: [\"A\", \"B\", \"C\", \"D\", \"E\"]\n}\n\nUR_DIMENSIONS_AND_SUBTYPES = {\n    1: [\"A\", \"B\", \"C\", \"D\", \"H\"],\n    2: [\"A\", \"B\", \"C\", \"D\", \"H\"],\n    3: [\"A\", \"B\", \"C\", \"D\", \"F\", \"H\"],\n    4: [\"A\", \"B\", \"C\", \"D\", \"F\", \"G\", \"H\"],\n}\n</code></pre>"},{"location":"shapes/u-family/#generating-a-u-core","title":"Generating a U Core","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\nimport copy\n\nbuilder = Builder(\"CadQuery\")\n\nu_shape = {\n    \"family\": \"u\",\n    \"name\": \"U 25/16/6\",\n    \"familySubtype\": \"1\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.025},\n        \"B\": {\"nominal\": 0.016},\n        \"C\": {\"nominal\": 0.006},\n        \"D\": {\"nominal\": 0.013},\n        \"E\": {\"nominal\": 0.006},\n    }\n}\n\ngeo_desc = [\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(u_shape),\n     \"rotation\": [0, 0, 0], \"coordinates\": [0, 0], \"machining\": None},\n    {\"type\": \"half set\", \"shape\": copy.deepcopy(u_shape),\n     \"rotation\": [3.14159265359, 0, 0], \"coordinates\": [0, 0], \"machining\": None},\n]\n\nstep_path, stl_path = builder.get_core(\"U_25_16_6\", geo_desc, output_path=\"./output/\")\n</code></pre>"},{"location":"testing/guide/","title":"Testing Guide","text":""},{"location":"testing/guide/#running-tests","title":"Running Tests","text":""},{"location":"testing/guide/#all-tests","title":"All Tests","text":"<pre><code>cd /path/to/MVB\npython -m unittest tests.test_builder\n</code></pre>"},{"location":"testing/guide/#single-test","title":"Single Test","text":"<pre><code>python -m unittest tests.test_builder.Tests.test_all_shapes_generated\n</code></pre>"},{"location":"testing/guide/#specific-test-modules","title":"Specific Test Modules","text":"<pre><code># 2D drawing tests\npython -m unittest tests.test_2d_drawings\n\n# Assembly tests\npython -m unittest tests.test_assembly\n\n# Bobbin tests\npython -m unittest tests.test_bobbin\n\n# Winding tests\npython -m unittest tests.test_winding\n\n# Full pipeline tests\npython -m unittest tests.test_full_pipeline\n\n# Complete magnetic tests\npython -m unittest tests.test_magnetic\n</code></pre>"},{"location":"testing/guide/#test-data","title":"Test Data","text":"<p>Test data files live in <code>tests/testData/</code>:</p> File Description <code>ETD49_N87_10uH_5T.json</code> ETD49 magnetic with N87 material <code>T402416_edge40_4uH_8T.json</code> Toroidal magnetic <code>C20_30u_8T_5mm.json</code> C-core magnetic <code>PQ4040_10u_6T_foil.json</code> PQ40 with foil winding <code>concentric_*.json</code> Various concentric winding configs <code>toroidal_*.json</code> Various toroidal winding configs"},{"location":"testing/guide/#mas-core-shapes","title":"MAS Core Shapes","text":"<p>The main shape generation tests require the MAS repository:</p> <pre><code>git clone https://github.com/OpenMagnetics/MAS.git ../MAS\n</code></pre> <p>The <code>core_shapes.ndjson</code> file at <code>../MAS/data/core_shapes.ndjson</code> contains all standard core shape definitions.</p>"},{"location":"testing/guide/#skipped-families","title":"Skipped Families","text":"<p>The following shape families are skipped in test_builder:</p> <ul> <li><code>ui</code> - U + I bar combination</li> <li><code>pqi</code> - PQ + I bar combination</li> <li><code>ut</code> - UT shape (limited support)</li> </ul>"},{"location":"testing/guide/#test-output","title":"Test Output","text":"<p>Tests produce output files in the <code>output/</code> directory at the project root. The <code>setUpClass</code> method cleans this directory before each test run.</p>"},{"location":"testing/guide/#test-structure","title":"Test Structure","text":"<pre><code>tests/\n\u251c\u2500\u2500 context.py              # Path setup for imports\n\u251c\u2500\u2500 test_builder.py         # Main shape generation tests\n\u251c\u2500\u2500 test_2d_drawings.py     # SVG/DXF/FCMacro drawing tests\n\u251c\u2500\u2500 test_assembly.py        # Assembly generation tests\n\u251c\u2500\u2500 test_bobbin.py          # Bobbin generation tests\n\u251c\u2500\u2500 test_winding.py         # Winding generation tests\n\u251c\u2500\u2500 test_full_pipeline.py   # End-to-end pipeline tests\n\u251c\u2500\u2500 test_magnetic.py        # Complete magnetic tests\n\u2514\u2500\u2500 testData/               # JSON test data files\n</code></pre>"},{"location":"testing/guide/#writing-new-tests","title":"Writing New Tests","text":"<p>Tests use Python's standard <code>unittest</code> framework:</p> <pre><code>import unittest\nimport context  # noqa: F401\nfrom builder import Builder\n\nclass TestMyFeature(unittest.TestCase):\n    @classmethod\n    def setUpClass(cls):\n        cls.builder = Builder(\"CadQuery\")\n\n    def test_something(self):\n        result = self.builder.get_core(\"test\", geo_desc)\n        self.assertIsNotNone(result)\n</code></pre> <p>The <code>context.py</code> module adds the source directory to <code>sys.path</code> so that imports work correctly from the test directory.</p>"},{"location":"tutorials/c-core-example/","title":"C-Core Example","text":"<p>Generate a C-shaped cut core with gapping and windings.</p>"},{"location":"tutorials/c-core-example/#overview","title":"Overview","text":"<p>C-cores are cut from a continuous toroidal or rectangular core. They inherit from the U-shape family and use the same dimension set.</p>"},{"location":"tutorials/c-core-example/#step-1-load-test-data","title":"Step 1: Load Test Data","text":"<pre><code>import json\n\nwith open(\"tests/testData/C20_30u_8T_5mm.json\") as f:\n    mas_data = json.load(f)\n</code></pre>"},{"location":"tutorials/c-core-example/#step-2-generate-the-complete-magnetic","title":"Step 2: Generate the Complete Magnetic","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\n\nbuilder = Builder(\"CadQuery\")\n\nstep_path, stl_path = builder.get_magnetic(\n    mas_data,\n    \"C20_30u\",\n    output_path=\"./output/\"\n)\n\nprint(f\"STEP: {step_path}\")\nprint(f\"STL:  {stl_path}\")\n</code></pre>"},{"location":"tutorials/c-core-example/#c-core-geometry","title":"C-Core Geometry","text":"<p>The C-core class inherits from U-core and uses U-family dimensions:</p> Dimension Description A Overall width B Overall height C Leg width D Window width E Leg depth"},{"location":"tutorials/c-core-example/#c-core-only","title":"C-Core Only","text":"<pre><code>import copy\n\nc_shape = {\n    \"name\": \"C 20\",\n    \"family\": \"c\",\n    \"familySubtype\": \"1\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.020},\n        \"B\": {\"nominal\": 0.020},\n        \"C\": {\"nominal\": 0.005},\n        \"D\": {\"nominal\": 0.010},\n        \"E\": {\"nominal\": 0.010},\n    },\n}\n\nc_geo_desc = [\n    {\n        \"type\": \"half set\",\n        \"shape\": copy.deepcopy(c_shape),\n        \"rotation\": [0, 0, 0],\n        \"coordinates\": [0, 0],\n        \"machining\": None,\n    },\n    {\n        \"type\": \"half set\",\n        \"shape\": copy.deepcopy(c_shape),\n        \"rotation\": [0, 3.14159265359, 0],\n        \"coordinates\": [0, 0],\n        \"machining\": None,\n    },\n]\n\nstep_path, stl_path = builder.get_core(\n    \"C_20\",\n    c_geo_desc,\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"tutorials/c-core-example/#c-core-vs-u-core","title":"C-Core vs U-Core","text":"Feature C-Core U-Core Shape C-shaped (two halves) U-shaped Pieces 2 (mirror pair) 1 or 2 Gap location At joint faces Optional machining Class hierarchy <code>C(U)</code> <code>U(IPiece)</code>"},{"location":"tutorials/c-core-example/#next-steps","title":"Next Steps","text":"<ul> <li>Core Generation Tutorial - E-core walkthrough</li> <li>Toroidal Winding Tutorial - toroidal example</li> <li>Shape Catalog - C Cores - full C-core details</li> </ul>"},{"location":"tutorials/complete-magnetic/","title":"Complete Magnetic Tutorial","text":"<p>Build a full ETD49 magnetic component from MAS JSON data, including core, bobbin, and coil windings.</p>"},{"location":"tutorials/complete-magnetic/#prerequisites","title":"Prerequisites","text":"<pre><code>pip install OpenMagneticsVirtualBuilder\n</code></pre> <p>Test data files are in <code>tests/testData/</code>.</p>"},{"location":"tutorials/complete-magnetic/#step-1-load-mas-data","title":"Step 1: Load MAS Data","text":"<p>MVB uses full MAS (Magnetic Assembly Schema) JSON files that describe the complete magnetic component:</p> <pre><code>import json\n\nwith open(\"tests/testData/ETD49_N87_10uH_5T.json\") as f:\n    mas_data = json.load(f)\n\n# The magnetic data is nested under the \"magnetic\" key\nmagnetic_data = mas_data[\"magnetic\"]\n</code></pre> <p>The MAS magnetic object contains:</p> <ul> <li><code>core</code> - shape, material, gapping</li> <li><code>coil</code> - bobbin, windings, turns</li> </ul>"},{"location":"tutorials/complete-magnetic/#step-2-generate-the-complete-magnetic","title":"Step 2: Generate the Complete Magnetic","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\n\nbuilder = Builder(\"CadQuery\")\n\nstep_path, stl_path = builder.get_magnetic(\n    mas_data,  # Builder handles the \"magnetic\" key extraction\n    \"ETD49_N87_10uH\",\n    output_path=\"./output/\"\n)\n\nprint(f\"STEP: {step_path}\")\nprint(f\"STL:  {stl_path}\")\n</code></pre> <p>The <code>get_magnetic()</code> method:</p> <ol> <li>Generates the core geometry (both halves)</li> <li>Creates the bobbin</li> <li>Builds each winding turn</li> <li>Combines everything into a single assembly</li> </ol>"},{"location":"tutorials/complete-magnetic/#step-3-generate-individual-components","title":"Step 3: Generate Individual Components","text":"<p>You can also generate components separately:</p>"},{"location":"tutorials/complete-magnetic/#core-only","title":"Core Only","text":"<pre><code>core_geo = magnetic_data[\"core\"][\"geometricalDescription\"]\n\nstep_path, stl_path = builder.get_core(\n    \"ETD49_core\",\n    core_geo,\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"tutorials/complete-magnetic/#bobbin-only","title":"Bobbin Only","text":"<pre><code>bobbin_data = magnetic_data[\"coil\"][\"bobbin\"]\nwinding_window = bobbin_data[\"processedDescription\"][\"windingWindows\"][0]\n\nstep_path, stl_path = builder.get_bobbin(\n    bobbin_data,\n    winding_window,\n    name=\"ETD49_bobbin\",\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"tutorials/complete-magnetic/#winding-only","title":"Winding Only","text":"<pre><code>winding_data = magnetic_data[\"coil\"]\n\nstep_path, stl_path = builder.get_winding(\n    winding_data,\n    {\"width\": winding_window[\"width\"], \"height\": winding_window[\"height\"]},\n    name=\"ETD49_winding\",\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"tutorials/complete-magnetic/#mas-data-structure","title":"MAS Data Structure","text":"<pre><code>{\n    \"magnetic\": {\n        \"core\": {\n            \"geometricalDescription\": [\n                {\n                    \"type\": \"half set\",\n                    \"shape\": { \"family\": \"etd\", \"dimensions\": {...} },\n                    \"machining\": [...]\n                }\n            ],\n            \"processedDescription\": {\n                \"gapping\": [...]\n            }\n        },\n        \"coil\": {\n            \"bobbin\": {\n                \"processedDescription\": {\n                    \"columnDepth\": 0.005,\n                    \"columnWidth\": 0.005,\n                    \"columnThickness\": 0.001,\n                    \"wallThickness\": 0.001,\n                    \"columnShape\": \"rectangular\",\n                    \"windingWindows\": [{\"height\": 0.01, \"width\": 0.003}]\n                }\n            },\n            \"functionalDescription\": [\n                {\n                    \"name\": \"Primary\",\n                    \"wire\": {\n                        \"type\": \"round\",\n                        \"conductingDiameter\": {\"nominal\": 0.001},\n                        \"outerDiameter\": {\"nominal\": 0.00105}\n                    }\n                }\n            ],\n            \"turnsDescription\": [\n                {\n                    \"coordinates\": [0.01, 0.005],\n                    \"winding\": \"Primary\",\n                    \"parallel\": 0\n                }\n            ]\n        }\n    }\n}\n</code></pre>"},{"location":"tutorials/complete-magnetic/#next-steps","title":"Next Steps","text":"<ul> <li>Technical Drawings Tutorial - generate 2D drawings</li> <li>Toroidal Winding Tutorial - toroidal example</li> <li>API Reference - full method documentation</li> </ul>"},{"location":"tutorials/core-generation/","title":"Core Generation Tutorial","text":"<p>This tutorial walks through generating 3D core geometry with gapping and technical drawings.</p>"},{"location":"tutorials/core-generation/#prerequisites","title":"Prerequisites","text":"<pre><code>pip install OpenMagneticsVirtualBuilder\n</code></pre>"},{"location":"tutorials/core-generation/#step-1-define-core-shape-data","title":"Step 1: Define Core Shape Data","text":"<p>Each core piece is described by its shape family, name, and dimensions following the MAS schema. Dimensions are in meters.</p> <pre><code>import copy\n\n# E 42/21/20 shape data\ne_core_shape = {\n    \"name\": \"E 42/21/20\",\n    \"family\": \"e\",\n    \"familySubtype\": \"1\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.042},\n        \"B\": {\"nominal\": 0.021},\n        \"C\": {\"nominal\": 0.0157},\n        \"D\": {\"nominal\": 0.0145},\n        \"E\": {\"nominal\": 0.0296},\n        \"F\": {\"nominal\": 0.0142},\n    },\n}\n</code></pre>"},{"location":"tutorials/core-generation/#step-2-create-geometrical-description","title":"Step 2: Create Geometrical Description","text":"<p>A typical E-core consists of two half-sets. The second piece is rotated 180 degrees around X to form the bottom half:</p> <pre><code>geometrical_description = [\n    {\n        \"type\": \"half set\",\n        \"shape\": copy.deepcopy(e_core_shape),\n        \"rotation\": [0, 0, 0],\n        \"coordinates\": [0, 0],\n        \"machining\": None,\n    },\n    {\n        \"type\": \"half set\",\n        \"shape\": copy.deepcopy(e_core_shape),\n        \"rotation\": [3.14159265359, 0, 0],  # 180 deg around X\n        \"coordinates\": [0, 0],\n        \"machining\": None,\n    },\n]\n</code></pre>"},{"location":"tutorials/core-generation/#step-3-generate-3d-model","title":"Step 3: Generate 3D Model","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\n\nbuilder = Builder(\"CadQuery\")\n\nstep_path, stl_path = builder.get_core(\n    \"E_42_21_20\",\n    geometrical_description,\n    output_path=\"./output/\"\n)\n\nprint(f\"STEP: {step_path}\")\nprint(f\"STL:  {stl_path}\")\n</code></pre> <p>This produces two files:</p> <ul> <li><code>output/E_42_21_20.step</code> - parametric CAD model</li> <li><code>output/E_42_21_20.stl</code> - mesh for visualization</li> </ul>"},{"location":"tutorials/core-generation/#step-4-add-gapping","title":"Step 4: Add Gapping","text":"<p>To add a center-leg gap, include machining data in the geometrical description:</p> <pre><code># 0.5 mm center-leg gap on the top half\ngeometrical_description_gapped = [\n    {\n        \"type\": \"half set\",\n        \"shape\": copy.deepcopy(e_core_shape),\n        \"rotation\": [0, 0, 0],\n        \"coordinates\": [0, 0],\n        \"machining\": [\n            {\n                \"type\": \"subtractive\",\n                \"length\": 0.0005,       # 0.5 mm gap\n                \"coordinates\": [0, 0, 0]  # center leg\n            }\n        ],\n    },\n    {\n        \"type\": \"half set\",\n        \"shape\": copy.deepcopy(e_core_shape),\n        \"rotation\": [3.14159265359, 0, 0],\n        \"coordinates\": [0, 0],\n        \"machining\": None,\n    },\n]\n\nstep_path, stl_path = builder.get_core(\n    \"E_42_21_20_gapped\",\n    geometrical_description_gapped,\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"tutorials/core-generation/#step-5-generate-technical-drawing","title":"Step 5: Generate Technical Drawing","text":"<pre><code>core_data = {\n    \"geometricalDescription\": geometrical_description_gapped,\n    \"processedDescription\": {\n        \"gapping\": [\n            {\n                \"type\": \"subtractive\",\n                \"length\": 0.0005,\n                \"coordinates\": [0, 0, 0]\n            }\n        ]\n    }\n}\n\nsvg = builder.get_core_gapping_technical_drawing(\n    \"E_42_gapped_drawing\",\n    core_data,\n    colors={\"projection_color\": \"#000000\", \"dimension_color\": \"#0000FF\"},\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"tutorials/core-generation/#machining-coordinates","title":"Machining Coordinates","text":"<p>The <code>coordinates</code> array in machining data controls gap placement:</p> <code>coordinates[0]</code> Location <code>0</code> Center leg <code>&gt; 0</code> Right outer leg <code>&lt; 0</code> Left outer leg <p><code>coordinates[1]</code> controls the vertical offset of the gap from the mating surface.</p>"},{"location":"tutorials/core-generation/#next-steps","title":"Next Steps","text":"<ul> <li>Complete Magnetic Tutorial - add bobbin and winding</li> <li>Technical Drawings Tutorial - SVG/DXF/FCMacro output</li> <li>Shape Catalog - browse all shape families</li> </ul>"},{"location":"tutorials/technical-drawings/","title":"Technical Drawings Tutorial","text":"<p>Generate annotated 2D technical drawings in SVG, DXF, and FreeCAD macro formats.</p>"},{"location":"tutorials/technical-drawings/#overview","title":"Overview","text":"<p>MVB supports three 2D output formats:</p> Format Extension Use Case SVG <code>.svg</code> Web display, documentation DXF <code>.dxf</code> CAD import (AutoCAD, LibreCAD) FCMacro <code>.FCMacro</code> FreeCAD sketch recreation"},{"location":"tutorials/technical-drawings/#svg-drawings","title":"SVG Drawings","text":""},{"location":"tutorials/technical-drawings/#core-shape-views","title":"Core Shape Views","text":"<p>Generate top and front SVG views of a core shape:</p> <pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\n\nbuilder = Builder(\"CadQuery\")\n\n# E 42/21/20 shape data\ne_shape = {\n    \"name\": \"E 42/21/20\",\n    \"family\": \"e\",\n    \"familySubtype\": \"1\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.042},\n        \"B\": {\"nominal\": 0.021},\n        \"C\": {\"nominal\": 0.0157},\n        \"D\": {\"nominal\": 0.0145},\n        \"E\": {\"nominal\": 0.0296},\n        \"F\": {\"nominal\": 0.0142},\n    },\n}\n\ngeometrical_description = [\n    {\n        \"type\": \"half set\",\n        \"shape\": e_shape,\n        \"rotation\": [0, 0, 0],\n        \"coordinates\": [0, 0],\n        \"machining\": None,\n    }\n]\n\nresults = builder.get_svg_drawings(\n    \"E_42_drawing\",\n    geometrical_description,\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"tutorials/technical-drawings/#gapping-technical-drawings","title":"Gapping Technical Drawings","text":"<p>Generate drawings with dimension annotations showing gap details:</p> <pre><code>import copy\n\ncore_data = {\n    \"geometricalDescription\": [\n        {\n            \"type\": \"half set\",\n            \"shape\": copy.deepcopy(e_shape),\n            \"rotation\": [0, 0, 0],\n            \"coordinates\": [0, 0],\n            \"machining\": [{\"type\": \"subtractive\", \"length\": 0.0005, \"coordinates\": [0, 0, 0]}],\n        },\n        {\n            \"type\": \"half set\",\n            \"shape\": copy.deepcopy(e_shape),\n            \"rotation\": [3.14159265359, 0, 0],\n            \"coordinates\": [0, 0],\n            \"machining\": None,\n        },\n    ],\n    \"processedDescription\": {\n        \"gapping\": [\n            {\"type\": \"subtractive\", \"length\": 0.0005, \"coordinates\": [0, 0, 0]}\n        ]\n    },\n}\n\nsvg = builder.get_core_gapping_technical_drawing(\n    \"E_42_gapped\",\n    core_data,\n    colors={\n        \"projection_color\": \"#000000\",\n        \"dimension_color\": \"#0000FF\",\n    },\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"tutorials/technical-drawings/#dxf-drawings","title":"DXF Drawings","text":"<p>DXF output uses cross-section slicing for precise edge geometry:</p> <pre><code>results = builder.get_dxf_drawings(\n    \"E_42_dxf\",\n    geometrical_description,\n    output_path=\"./output/\"\n)\n</code></pre> <p>Note</p> <p>DXF export requires the <code>ezdxf</code> package: <code>pip install ezdxf</code></p>"},{"location":"tutorials/technical-drawings/#freecad-macro-sketches","title":"FreeCAD Macro Sketches","text":"<p>Generate <code>.FCMacro</code> files that recreate the 2D sketch in FreeCAD:</p> <pre><code>results = builder.get_fcstd_sketches(\n    \"E_42_sketch\",\n    geometrical_description,\n    output_path=\"./output/\"\n)\n</code></pre>"},{"location":"tutorials/technical-drawings/#view-planes","title":"View Planes","text":"<p>Drawings can be generated for three principal view planes:</p> Plane Normal Direction Typical View XY Z axis (top-down) Top view XZ Y axis (front) Front view ZY X axis (side) Side / cross-section view"},{"location":"tutorials/technical-drawings/#drawing-2d-module","title":"Drawing 2D Module","text":"<p>For advanced customization, use the <code>drawing_2d</code> module directly:</p> <pre><code>from OpenMagneticsVirtualBuilder.drawing_2d import (\n    ViewPlane,\n    ViewType,\n    DimensionAnnotation,\n    cross_section_at_plane,\n    create_dimension_svg,\n)\n\n# Slice a shape at the ZY plane\nsection = cross_section_at_plane(shape, ViewPlane.ZY, offset=0.0)\n</code></pre>"},{"location":"tutorials/technical-drawings/#customizing-colors","title":"Customizing Colors","text":"<p>Both projection lines and dimension annotations support custom colors:</p> <pre><code>colors = {\n    \"projection_color\": \"#333333\",   # Dark gray shape outline\n    \"dimension_color\": \"#0066CC\",    # Blue dimension lines\n}\n</code></pre>"},{"location":"tutorials/technical-drawings/#next-steps","title":"Next Steps","text":"<ul> <li>Core Generation Tutorial - generate 3D geometry first</li> <li>2D Drawing API Reference - full module documentation</li> </ul>"},{"location":"tutorials/toroidal-winding/","title":"Toroidal Winding Tutorial","text":"<p>Build a toroidal (ring) core magnetic component with windings.</p>"},{"location":"tutorials/toroidal-winding/#overview","title":"Overview","text":"<p>Toroidal cores are fundamentally different from concentric cores (E, PQ, etc.):</p> <ul> <li>The core is a ring that revolves around the Y axis</li> <li>Turns are wound through the center hole</li> <li>MAS coordinates use radial distance and angular position</li> </ul>"},{"location":"tutorials/toroidal-winding/#step-1-load-test-data","title":"Step 1: Load Test Data","text":"<pre><code>import json\n\nwith open(\"tests/testData/T402416_edge40_4uH_8T.json\") as f:\n    mas_data = json.load(f)\n</code></pre>"},{"location":"tutorials/toroidal-winding/#step-2-generate-the-complete-magnetic","title":"Step 2: Generate the Complete Magnetic","text":"<pre><code>from OpenMagneticsVirtualBuilder.builder import Builder\n\nbuilder = Builder(\"CadQuery\")\n\nstep_path, stl_path = builder.get_magnetic(\n    mas_data,\n    \"T402416_4uH\",\n    output_path=\"./output/\"\n)\n\nprint(f\"STEP: {step_path}\")\nprint(f\"STL:  {stl_path}\")\n</code></pre>"},{"location":"tutorials/toroidal-winding/#toroidal-core-geometry","title":"Toroidal Core Geometry","text":"<p>A toroidal core requires only three dimensions:</p> Dimension Description A Outer diameter B Inner diameter C Height (thickness) <pre><code>t_core_shape = {\n    \"name\": \"T 40/24/16\",\n    \"family\": \"t\",\n    \"familySubtype\": \"1\",\n    \"dimensions\": {\n        \"A\": {\"nominal\": 0.0404},\n        \"B\": {\"nominal\": 0.0246},\n        \"C\": {\"nominal\": 0.0163},\n    },\n}\n</code></pre>"},{"location":"tutorials/toroidal-winding/#toroidal-core-only","title":"Toroidal Core Only","text":"<pre><code>import copy\n\nt_geo_desc = [\n    {\n        \"type\": \"closed piece\",\n        \"shape\": copy.deepcopy(t_core_shape),\n        \"rotation\": [0, 0, 0],\n        \"coordinates\": [0, 0],\n        \"machining\": None,\n    }\n]\n\nstep_path, stl_path = builder.get_core(\n    \"T_40_24_16\",\n    t_geo_desc,\n    output_path=\"./output/\"\n)\n</code></pre> <p>Note</p> <p>Toroidal cores use <code>\"type\": \"closed piece\"</code> since they are a single piece (unlike E-cores which use <code>\"half set\"</code>).</p>"},{"location":"tutorials/toroidal-winding/#coordinate-system","title":"Coordinate System","text":"<p>For toroidal cores, the coordinate mapping is:</p> Axis Direction X Radial (negative X = inside the hole) Y Core axis (toroid revolves around Y) Z Tangential direction <p>MAS turn coordinates for toroidal cores:</p> <ul> <li><code>coordinates[0]</code> = radial distance from Y axis</li> <li><code>coordinates[1]</code> = angular position (rotation around Y axis)</li> </ul>"},{"location":"tutorials/toroidal-winding/#winding-styles","title":"Winding Styles","text":"<p>Toroidal windings pass through the center hole of the core. The CadQuery engine creates each turn as a torus swept along the winding path.</p> <pre><code># Example turn in MAS format\nturn = {\n    \"coordinates\": [0.015, 0.2],  # radial, angular\n    \"winding\": \"Primary\",\n    \"parallel\": 0,\n    \"turnIndex\": 0\n}\n</code></pre>"},{"location":"tutorials/toroidal-winding/#next-steps","title":"Next Steps","text":"<ul> <li>C-Core Example - another core type</li> <li>Core Generation Tutorial - E-core walkthrough</li> <li>Shape Catalog - Toroidal - toroidal details</li> </ul>"}]}